---
toc: true
layout: post
title: SIDE)추상체X추상체 관계에서 템플릿,전략패턴 적용
description: 추상체x추상체의 if instanceof를 템플릿, 전략패턴 적용

categories: [python, recursive, tailrecursive, loop]
image: "images/posts/java.png"
---



### 반복문 -> 꼬리 재귀 만드는 법

#### 2개 변수 누적연산의 피보나치를 단계별로

- 초기 코드: 0부터 n까지 피보나치 함수

  ```python
  def tail_recursive_fibo(n):
      # 반복문과 관계없이 바로 return되는 초기값들
      if n <= 1:
          return n
  
      # n >=2 부터 반복문에 의해 계산된다. 
      a, b = 0, 1
      for i in range(2, n + 1):
          a, b = b, a + b
  
      return b
  ```

  

1. 꼬리재귀는 **n이외에 최소 1개 파라미터가 추가(누적결과변수를 파라미터로 업데이트)하므로 `재귀 호출함수로 꼬리재귀함수를 메소드로 분리`한다.**

   - 함수명은 helper를 쓰면 된다.

   ![69b0dc23-3770-43bd-ad3f-fac1a8d0e74c](https://raw.githubusercontent.com/is3js/screenshots/main/69b0dc23-3770-43bd-ad3f-fac1a8d0e74c.gif)


   ![image-20220706181951440](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220706181951440.png)



2. **꼬리재귀형태를 만들기 위해  `반복문후 반환되는 누적결과값 변수b의 업데이트 로직`파라미터로서 추가하고  `n을 1개 깍은 n-1의 업데이트로직`을  반영한 `return 꼬리재귀( 업데이트 로직)`을  함수 맨 마지막 단독return한다**

   - **그 과정에서 원래 함수에 업데이트 전 원래 누적결과값 변수b를 파라미터로 추가한다.**
     - **이 때, b를 업데이트 하는 로직에 `반복문의 i가 사용되었다면 n으로 대체해서 업데이트 로직을 반영`한다.**
   - n번째 업데이트에 대해 **좌측 식별자 -> 정의 꼬리재귀 파라미터 / 우측 업데이트 값 -> 다음 꼬리재귀 호출부**형태로 만들어줘서, 다음 호출시 업데이트 된 값이 들어가게 한다.

   ![d902b190-95c7-469c-a4ed-7db16ac152aa](https://raw.githubusercontent.com/is3js/screenshots/main/d902b190-95c7-469c-a4ed-7db16ac152aa.gif)

   ![image-20220706183242207](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220706183242207.png)

3. **누적결과값 반환변수b이외에 a라는 식별자도 업데이트되어 사용되기 때문에**

   - 호출부에는 업데이트 로직
   - 정의부에는 변수를 넣어준다.

   ![4c1fe5fc-c4b2-4bad-8d2b-b5342842dc2c](https://raw.githubusercontent.com/is3js/screenshots/main/4c1fe5fc-c4b2-4bad-8d2b-b5342842dc2c.gif)

   ![image-20220706183604289](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220706183604289.png)





4. **초기값 및 초기값으로 인해 `반복문이 돌지 않는 부분`은 `종착역`이 된다.**

   - n=2서부터 도니까 **최종 연산은 n==2까지 재귀되어야하며, `꼬리재귀는 최종연산값 다음번 n==1이 종착역`으로서 `최종결과값 변수b만 반환`해준다.**

   ![8822f387-d70e-4b80-85c0-115187be56bf](https://raw.githubusercontent.com/is3js/screenshots/main/8822f387-d70e-4b80-85c0-115187be56bf.gif)

   ![image-20220706183808291](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220706183808291.png)



5. **`n이외에 업데이트되는 변수들은 초기값을 꼬리재귀 호출시 넣어준다.`**

   ![7ac24c81-f68e-4965-9d80-cd7e6b829540](https://raw.githubusercontent.com/is3js/screenshots/main/7ac24c81-f68e-4965-9d80-cd7e6b829540.gif)

   ![image-20220706184311535](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220706184311535.png)

   

6. **초기값들을 n반환 대신 추가된 초기값을 가진 업데이트 변수**가 되도록 수정해준다.

   ![ca5ccc0a-33d4-4a60-ad0e-676f1b9fcced](https://raw.githubusercontent.com/is3js/screenshots/main/ca5ccc0a-33d4-4a60-ad0e-676f1b9fcced.gif)

   ![image-20220706184527733](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220706184527733.png)


```python
def tail_recursive_fibo(n):
    return helper(n, 0, 1)


def helper(n, a, b):
    if n == 0:
        return a

    if n == 1:
        return b

    return helper(n - 1, b, a + b)
```



#### 1개 변수 업데이트되는 누적합

- 코드

  ```python
  def loop_sum(n):
      s = 0
      for i in range(1, n + 1):
          s += i
      return s
  ```

- 과정

  ![7fd7b046-581e-422e-82d0-a69bc7d40322](https://raw.githubusercontent.com/is3js/screenshots/main/7fd7b046-581e-422e-82d0-a69bc7d40322.gif)





- 최종

  ````java
  def loop_sum(n):
      return helper(n, 0)
  
  
  def helper(n, s):
      if n == 0:
          return s
  
      return helper(n-1, s + n)
  ````

  