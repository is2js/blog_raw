---
toc: true
layout: post
title: stream ìŠ¤íŠ¸ë¦¼ ì‚¬ìš©ì˜ˆì‹œ ëª¨ìŒ
description: missionê°„ streamê´€ë ¨ ì‚¬ìš©ì˜ˆì‹œ ëª¨ìŒ
categories: [java, ìš°í…Œì½”, mission, stream, TDD]
image: "images/posts/java.png"
---


### Stream  ê¸°ë³¸

#### í”„ë¦¬ì½”ìŠ¤ë•Œ í•œ ê²ƒ

- String ì—­ ì¶œë ¥
     -> new StringBuilder( string ) .reverse().toString()
     -> split -> stream -> list -> Collections.reverse( list )ê°€ inplace ì—­ìˆœì‹œí‚¨ë‹¤. -> stream + reduce + getìœ¼ë¡œ ë¬¸ìì—´ ëª¨ìœ¼ê¸°

- arr 2ê°œ í•©ì¹˜ê¸° 
     -> Stream.of( arr1, arr2) .flatMap(Stream::of) .collect(Collectors.toList());

- list 2ê°œ í•©ì¹˜ê¸° ( streamì—†ì´ í• ë ¤ë©´, ë¹ˆë¦¬ìŠ¤íŠ¸ì— addAll + addAll )
     -> Stream.concat( list1.stream(), list2.stream())

- list ì¤‘ë³µì œê±° 
     -> list.stream().distinct() + .collect(Collectors.toList())

- listì˜ ì§‘ê³„í•¨ìˆ˜ ë§Œë“¤ê¸° by reduce().get() + Integer::sum 
     -> list.stream() .reduce(Integer::sum) .get();

- ìŒìˆ˜ê²€ì‚¬: IntStreamë§Œë“¤ì–´ì„œ custom booleanì‹ ë§Œë“¤ê³  filterì— ë„£ê¸°
     -> Arrays.stream(mathexpression.split(",|:")) .mapToInt(Integer::parseInt) .filter(i -> checkNegative(i)) // .sum();

- ìˆ«ìì‚¬ì´ ì—°ì‚°ìë“¤ì˜ ì—°ì†ì…ë ¥ ê²€ì‚¬ :
     -> if (Arrays.stream(removedSpaceInput.split("[0-9]")).anyMatch(operator -> operator.length() > 1)) {

- ê°ì²´ì† ë³€ìˆ˜2ê°œë¡œ -> map key, valueë§Œë“¤ê¸°
     -> list.stream() 
        	// .sorted(Comparator.comparingInt(Item::getId).reversed()) 
        	.collect(Collectors.toMap( 
        		Item::getId, Item::getValue, 
        		(OldId, newId) -> OldId, // (OldId, newId) -> newId, 
        		LinkedHashMap::new ));



#### .filter() ì‹ ê¸°í•œ ê²ƒ

1. anyMatch ë¥˜ëŠ” í•´ë‹¹í•˜ëŠ” ê²ƒë“¤ë§Œ í•„í„°ë§ ëœë‹¤.

2. stringì„ ëŒê³  ìˆë‹¤ë©´, str.indexOf("íŠ¹ì •ë¬¸ì") == 2 ë“±ê³¼ ê°™ì´  íŠ¹ì •ë¬¸ìì—´ 1ê°œì˜ ìœ„ì¹˜ë¡œ í•„í„°ë§ ê°€ëŠ¥í•˜ë‹¤

    ```java
    Arrays.stream(input.split("#")) // í™ê¸¸ë™:100 , ì´ìˆœì‹ :90
        .flatMap(str -> Stream.of(str.split(":"))) // {í™ê¸¸ë™, 100} , {ì´ìˆœì‹ ,90} -> í™ê¸¸ë™,100,ì´ìˆœì‹ ,90
        .filter(it -> it.indexOf("ì‹ ") == 2)
        .findFirst()
        .ifPresent(s-> System.out.println(s));
    ```

    

3. **nullì•„ë‹Œ ê²ƒë§Œ í•„í„°ë§ í•˜ë ¤ë©´** Objects.notnull()ì„ í•„í„°ì— ë„£ì–´ì£¼ë©´ ëœë‹¤.

    ```java
    Collection<String> animals = Arrays.asList("Dog", "Cat", null, "Moose");
    String result = animals.stream()
        .filter(Objects::nonNull)
        .collect(Collectors.joining(", "));
    ```

    

    

#### ì´ì¤‘ë°˜ë³µë¬¸

##### ì´ì¤‘ë°˜ë³µë¬¸ + ì¡°ê±´ì‹  -> ìš”ì†Œ1vsìš”ì†Œ2 í•„í„°ë§ by .filter(  .anyMatch() )

- java8ì´ì „

    ```java
    final List<String> abcde = List.of("a", "b", "c", "d", "e");
    final List<String> abd = List.of("a", "b", "d");
    
    // 8ì´ì „: ì´ì¤‘ forë¬¸ + ì¡°ê±´ì‹ -> ë°˜ë³µë¬¸ë‚´ ì¡°ê±´ë§Œì¡±ê°’ì„ ëª¨ì„ ê²°ê³¼ê°’ ê°€ë³€ë³€ìˆ˜ì— add
    final List<String> result = new ArrayList<>();
    
    for (final String str1 : abcde) {
        for (final String str2 : abd) {
            if (str1.equals(str2)) {
                result.add(str1); // ê°™ìœ¼ë‹ˆê¹Œ ë‘˜ì¤‘ì— í•˜ë‚˜ë§Œ ë‹´ê¸°
            }
        }
    }
    
    System.out.println("result = " + result);
    //result = [a, b, d]
    ```

    

- java8 Stream

    - **ë°”ê¹¥Stream.filter() + ì•ˆìª½Stream.anyMatch()**

    ```java
    //1. ì²«ë²ˆì§¸ listë¥¼ ëŒ ë•Œ, 2ë²ˆì§¸ listê°€ ëŒì•˜ë‹¤ê³  ê°€ì •í•˜ê³  ë‘˜ì´ì„œ conditionì¡°ê±´ì‹ì„ ë¹„êµí•˜ë¯€ë¡œ
    // -> .map()ì´ë‚˜ .collect()ê°€ ì•„ë‹Œ .filter( 1stElement -> )ë¡œ ì‹œì‘í•˜ëŠ” ê²ƒì„ ìœ ì˜í•´ì•¼í•œë‹¤.
    // -> my) ëŒë©´ì„œ ì¡°ê±´ì‹ -> stream().filter()
    //.filter( str1 -> str1)
    //2. ëŒë‹¤ì‹ -> ìš°ì¸¡ì—ëŠ” 1ë²ˆì§¸ ìš”ì†Œ ì´ì „ì— 2ë²ˆì§¸ listê°€ ë¨¼ì € streamìœ¼ë¡œ í’€ì–´ì ¸ì•¼í•˜ë¯€ë¡œ, list2ë¶€í„°ë“±ì¥í•˜ëŠ” ê²ƒì„ ìœ ì˜í•´ì•¼í•œë‹¤.
    //.filter( str1 -> abd.stream(). )
    // -> 2list.stream()ì´í›„   2ë²ˆì§¸ ìš”ì†Œê°€ ë“±ì¥í•œë‹¤ê³  ê°€ì •í•˜ë©´, ë­˜ í•  ê²ƒì¸ê°€ ë¥¼ ë¨¼ì € ìƒê°í•˜ê³  .ë©”ì„œë“œ()ë¥¼ í˜¸ì¶œí•´ì•¼í•œë‹¤.
    // -> .stream(). ??? ( 2ë²ˆì¬ìš”ì†Œ -> 1ë²ˆì§¸ìš”ì†Œë‘ .equals()ë“±ì˜ ì¡°ê±´ì‹ì„ ë‹¤ë£° ê²ƒ)ì´ë¯€ë¡œ
    // --> 2ë²ˆì§¸ streamì˜ ìš”ì†ŒëŠ”  ì¡°ê±´ì‹ì¸ anyMatch/allMatch/noneMatch( ) ë‚´ë¶€ì—ì„œ 1ë²ˆì§¸ ìš”ì†Œë¥¼ ë§ì´í•œë‹¤.
    // --> ì´í›„ filter( ë‚´ë¶€ì—ì„œ í•´ë‹¹ ì¡°ê±´ì‹ì„ í†µê³¼í•˜ëŠ” ê²ƒë§Œ ë‚¨ê²¨ì§„ë‹¤.)
    final List<String> result2 = abcde.stream()
        .filter(str1 -> abd.stream()
                //        .( str2 -> str2.equals(str1))
                .anyMatch(str2 -> str2.equals(str1)))
        // str1 1ê°œì— ëŒ€í•´, list2 ì¤‘ì— ì–´ëŠí•˜ë‚˜ë¼ë„ ë§Œì¡±í•œë‹¤ë©´, í†µê³¼?
        // -> filter( anyMatch( ì¡°ê±´ì‹ )-> ì–´ëŠí•˜ë‚˜ë¼ë„?(X) ë§Œì¡±í•˜ëŠ” ê²ƒë§Œ í•„í„°ë§í•œë‹¤**
        // --> filter( noneMatch( ì¡°ê±´ì‹ ) ->ëª¨ë‘ë¶ˆë§Œì¡±ì‹œ true?(X) ë¶ˆì¼ì¹˜í•˜ëŠ” ê²ƒë§Œ í•„í„°ë§**
        .collect(Collectors.toList());
    
    System.out.println("result2 = " + result2);
    //result2 = [a, b, d]
    
    //ì•”ê¸°í•˜ìë©´ - list1 + list2 + ì¡°ê±´ì‹ì´ë‹¤?
    //list1.stream().filter()ë¡œ ì‹œì‘í•˜ì—¬ e1ì€ ê²°êµ­ e2ì™€ ì¡°ê±´ì‹ì„ ë¹„êµí•´ì„œ ifí•„í„°ë§í•´ì„œ ëª¨ì•„ì•¼í•œë‹¤.
    //list2.stream().anyMatch( e2 -> e1ê³¼ì¡°ê±´ì‹)ìœ¼ë¡œ [ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ë°ì´í„°ë§Œ trueì²´í¬]í•œ ë’¤, filterë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆê²Œ í•œë‹¤.
    //ëª¨ì€ë‹¤.
    result2.forEach(System.out::print);
    ```

    





![image-20220414080954508](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220414080954508.png)

- ë‚´ë¶€ Streamìœ¼ë¡œ ë°”ê¹¥ë°˜ë³µë¬¸Stream ì…ì¥ì—ì„œ ë‚´ë¶€ë°˜ë³µë¬¸orë¶„ì‹ ìˆ ì—ì˜í•œ Stream<>ì´ ìƒê²¼ë‹¤.
    - ì´ ë•Œ, ë°”ê¹¥ì—ì„œ flatMap()ì„ ì³ì£¼ë©´, ë‚´ë¶€ Streamì„ ë°”ê¹¥ì…ì¥ì—ì„œ ë™ë“±í•˜ê²Œ 1ê°œì”© ë³´ë‚´ì¤„ ìˆ˜ ìˆë‹¤.





##### ì´ì¤‘ë°˜ë³µë¬¸ + ìš”ì†Œ1,2ë¥¼ ì¬ë£Œë¡œ ìƒˆê°ì²´ ìƒì„± by .flatMap(  .map() ) 

- map( .map( -> ìƒˆê°ì²´ )) ì´í›„ ë°”ê¹¥ìª½ì„ `flatMap`ìœ¼ë¡œ ê³ ì³ì£¼ë©´, `**Stream<Stream<>>` ì—ì„œ e1ë‹¹ list2ì˜ ë¶„ì‹ ìˆ ë“¤ì´ 1ê°œì‹ ë™ë“±í•˜ê²Œ ë„˜ì–´ê°€ë„ë¡ í´ì§„ë‹¤.**

    ![image-20220414083001227](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220414083001910.png)

    ```java
    //2ì¤‘ forë¬¸ + ìƒì„±ì -> e1, e2 1ê°œì”© ì¬ë£Œë¡œ í™œìš©í•´ì„œ ìƒˆê°ì²´ ëª¨ìœ¼ê¸°
    // enum 2ê°œê°€ ë°˜ë³µë¬¸ì„ 2ë²ˆ ëŒ ê²ƒì„.
    
    Arrays.stream(Suit.values())
        // ì¼ë‹¨, e1ì´ ê²°êµ­ì—” e2ì™€ ë§Œë‚˜ì„œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•  ê²ƒì´ë‹ˆ filter( e1->)ì´ ì•„ë‹ˆë¼ map(e1->ìœ¼ë¡œ ì‹œì‘í•œã„·)
        //.map(e1-> )
        .map(e1 -> Arrays.stream(Denomination.values())
             //e2ë„ ê²°êµ­ì—” e1ê³¼ ë§Œë‚˜ì„œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•˜ë‹ˆ mapìœ¼ë¡œ ì‹œì‘í•œë‹¤.
             //.map(e2 ->)
             .map(e2 -> PlayingCard.of(e1, e2)))
        // ì•ˆìª½ streamì€ collectë¥¼ í•˜ì§€ ì•Šê³  -> anyMatchì˜ trueì²´í¬ëœ Stream<Boolean?ê²°ê³¼ë¬¼> or mapì˜ Stream<PlayingCardê²°ê³¼ë¬¼>ë¡œì„œ Streamì„ ìœ ì§€í•œë‹¤.
        // ì•ˆìª½streamì˜ ì•ˆëª¨ìœ¼ê³  ì¤‘ê°„ì—°ì‚°ë§Œ í–ˆë‹¤ë©´, Stream< Stream<>>ì¼ ê²ƒì´ë‹¤. ->  ë°”ê¹¥ì—ì„œë§Œ ëª¨ì€ë‹¤ë©´, ë°”ê¹¥ë§Œ listí™”ë˜ì„œ -> List<Stream<PlayingCard>> Typeì´ ëœë‹¤.
        .collect(Collectors.toList());
    
    Arrays.stream(Suit.values())
        //e1 vs list2ë“¤ì´ ëŒë©´ì„œ, Stream ( Stream<mapëœê°ì²´> ,   Stream<mapëœê°ì²´> , Stream<mapëœê°ì²´>  )í˜•íƒœë¡œ
        // -> ë°”ê¹¥ ìš”ì†Œì— ëŒ€í•´ Stream< Stream<ê°ì²´> >ê°€ ëœ ìƒíƒœì´ë‹ˆ,
        // -> ì•ˆìª½Stream()ì— ì˜í•œ ë¶„ì‹ ìˆ ì„ ê°œë³„ Streamìœ¼ë¡œ ì¸ì •í•´ì£¼ëŠ” flatmapì„ ë°”ê¹¥ì—ì„œ ì ìš©í•œë‹¤.
        // --> Stream( <mapëœê°ì²´1><mapëœê°ì²´2><mapëœê°ì²´3> ,   <mapëœê°ì²´4><mapëœê°ì²´5><mapëœê°ì²´6> ,  <mapëœê°ì²´7><mapëœê°ì²´8><mapëœê°ì²´9>  ]
        // ì¦‰, flatmapì€, [ì•ˆìª½ì—ì„œ ë¶„ì‹ ìˆ orë°˜ë³µë˜ëŠ” splitì´ë‚˜ streamìœ¼ë¡œ ìª¼ê°œì§„ ê²ƒë„ -> ë°”ê¹¥Streamì— 1ê°œì”© ì „ë‹¬ë˜ë„ë¡ ì´ì •í•´ì£¼ëŠ” ê²ƒ]
        .flatMap(e1 -> Arrays.stream(Denomination.values())
                 .map(e2 -> PlayingCard.of(e1, e2)))
        .collect(Collectors.toList());
    ```

    ![image-20220414083045141](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220414083045141.png)





##### ë‚´ë¶€ì—ì„œ ë¶„ì‹ ìˆ ë¡œ ìƒê¸´ `Stream<ì»¬ë ‰ì…˜<>>` -> Stream.of()ë¡œ `Stream<Stream<>>`ìœ¼ë¡œ ë§Œë“  ë’¤ -> flatMap





![image-20220414011604604](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220414011604604.png)

- splitìœ¼ë¡œ ë¶„ì‹ ìˆ ë¡œ ê°¯ìˆ˜ê°€ ëŠ˜ì–´ë‚œ ë‹¨ì¼ìš”ì†ŒëŠ” `ë°°ì—´String[]`ë“¤ì´ streamìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤.

![image-20220414011708287](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220414011708287.png)

- ëŠ˜ì–´ë‚œ ë¶„ì‹ ìˆ (ë°°ì—´)ì„ `Stream.of()`ë¡œ ê°ì‹¸ë©´, `Stream<String>`ë“¤ì´ streamìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤.

![image-20220414012127156](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220414012127156.png)

- Stream.of(ë¶„ì‹ ìˆ )ë“¤ì„ map ëŒ€ì‹  flatMapìœ¼ë¡œ `ë³€í™˜í›„ ë­‰ì¹˜ë©´` íŒíŠ¸ê°€ ì‚¬ë¼ì§„ë‹¤.

    - ë¶„ì‹ ìˆ ë“¤ë„ ê°œë³„ 1ê°œì”©ì´ ìˆœì„œëŒ€ë¡œ 1ê°œì”© ë„˜ì–´ì˜¨ë‹¤

        ![image-20220414012257365](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220414012257365.png)




- java8ì´ì „

    ```java
    // 8ë²„ì „ ì´ì „
    // 2ë²ˆ splití•´ì„œ, ì´ìˆœì‹ ì¸ ê²½ìš° ê·¸ ì ìˆ˜ë¥¼ ì¶œë ¥
    final String input = "í™ê¸¸ë™:100#ì´ìˆœì‹ :90";
    final String[] splitInput = input.split("#");
    
    for (final String nameAndScore : splitInput) {
        final String[] splitNameAndScore = nameAndScore.split(":");
        final String name = splitNameAndScore[0];
        final String score = splitNameAndScore[1];
        if ("ì´ìˆœì‹ ".equals(name)) {
            System.out.println(score);
        }
    }
    ```

- stream

    ```java
    final String input = "í™ê¸¸ë™:100#ì´ìˆœì‹ :90";
    
    Arrays.stream(input.split("#"))
        .map(str -> str.split(":"))
        .collect(Collectors.toList());
    
    Arrays.stream(input.split("#"))
        // .map( -> ë‚´ë¶€ë°˜ë³µë¬¸orë¶„ì‹ ìˆ ) ë¡œ Stream< String[] > í˜•íƒœë¡œ Stream <  ë°°ì—´/ì»¬ë ‰ì…˜ > ì´ ìƒê²¼ë‹¤ë©´,
        // -> Stream.of()ë¡œ ì´ì„œ, Stream< Stream< > > í˜•íƒœë¡œ ë§Œë“¤ì–´ì¤˜ì•¼
        .map(str -> Stream.of(str.split(":")))
        .collect(Collectors.toList());
    
    Arrays.stream(input.split("#"))
        // flatMap()ìœ¼ë¡œì„œ, ë‚´ë¶€ ìª¼ê°œì§„ ê²ƒë“¤ì´ 1ê°œì”© ë³´ë‚¼ ìˆ˜ ìˆê²Œ ëœë‹¤.
        // -> ì¦‰, ì•ˆìª½ì—ì„œ ëŒë•Œ .stream()ìœ¼ë¡œ ë„ëŠ”ê²Œ ì•„ë‹ˆë¼  splitë“± ë¶„ì‹ ìˆ ì„ ì¼ë‹¤ë©´, Stream.of()ë¡œ ì”Œì›Œì¤˜ì•¼ ë°”ê¹¥ì—ì„œ flatMapì„ ë§¥ì¼ ìˆ˜ ìˆë‹¤.
        .flatMap(str -> Stream.of(str.split(":")))
        .collect(Collectors.toList());
    //í™ê¸¸ë™
    //100
    //ì´ìˆœì‹ 
    //90
    ```

    





#### ì™¸ë¶€List.of()ë¥¼ ë°°ë ¤í•œ ê°€ë³€ì¸ì(ë°°ì—´)ì˜ ë‚´ë¶€ì²˜ë¦¬ëŠ” streamë³´ë‹¤ëŠ” List.of()

- ë°°ì—´ -> `.stream()`ì˜ POSFIX completion -> `.toList()`ë¥¼ í•´ë„ ë˜ì§€ë§Œ
- **ì¼ê´„ì²˜ë¦¬ ë“± ì‘ì—…ì´ ì—†ë‹¤ë©´ ê·¸ëƒ¥ ì™¸ë¶€ì—ì„œ ì“°ë˜ `List.of( ê°€ë³€ë°°ì—´ )`ì„ ê·¸ëŒ€ë¡œ ì“°ë©´ ëœë‹¤.**

```java
//ë°°ì—´ -> stream -> toList
public Cards(final Card... cards) {
    this(Arrays.stream(cards)
         .collect(Collectors.toList()));
}

//ë°°ì—´ -> List.of(ë°–ì—ì„œ ì“°ë˜ ê²ƒ ê·¸ëŒ€ë¡œ ë‚´ë¶€ì—ì„œ ì“°ê¸°)

```



#### ê°™ì€Typeì— ëŒ€í•´ ì¼ê´„ì²˜ë¦¬: List.ofë¡œ ë‹´ì•„ + stream.ì¼ê´„ì²˜ë¦¬  ---> Stream.of().ì¼ê´„ì²˜ë¦¬



- ê°œë³„ Cardê°ì²´ì— ëŒ€í•´ ì¼ê´„ì ìœ¼ë¡œ isAceì¸ì§€ ë¬¼ì–´ë³´ê³  ì‹¶ë‹¤.

    - ê°œë³„Cardë“¤ì„ **`List.of()`ì˜ ì»¬ë ‰ì…˜ì— ë‹´**ê³  -> **`stream(). ì¼ê´„ì²˜ë¦¬`**

    ```java
    final boolean hasAce = List.of(first, second)
        .stream()
        .anyMatch(it -> it.isAce());
    ```

    - intellijì¶”ì²œ **`ê°™ì€í˜•`ì´ë©´ `Stream.of( , , )ì— ë‹´ì•„ì„œ í•œë²ˆì— ì¼ê´„ì²˜ë¦¬**

    ```java
    final boolean hasAce = Stream.of(first, second)
        .anyMatch(Card::isAce);
    ```



##### ê°™ì€ ë„ë©”ì¸ì´ë¼ë©´ `List.of()`ë‚˜ `Stream.of()`ë¡œ ë¬¶ì–´ì„œ `ë©”ì„¸ì§€ë³´ë‚´ ì¼ê´„ì²˜ë¦¬` or `ë‚´ë¶€ë³€ìˆ˜ mapë³€í™˜ ë‹¨ìˆœì§‘ê³„`ê°€ ê°€ëŠ¥í•˜ë©°, `ì§‘ê³„ëŠ” map + .getter()`ë¡œ `ì§‘ê³„ëŒ€ìƒì˜ ë³€ìˆ˜ë¥¼ getterìœ¼ë¡œ ë³€í™˜`í•˜ëŠ” ê³¼ì •ì„ ê±°ì³ì„œ í•œë‹¤.



- ê°œë³„ë¡œ getterë¥¼ ì¨ì„œ ì¼ì¼íˆ ë‹¤ ë”í•˜ëŠ” ê²½ìš°

    ```java
    public static Object start(final Card first,
                               final Card second) {
        final int sum = first.point() + second.point();
    ```

- **ê°™ì€í˜•ì´ë¼ `ë¬¶ì–´ì„œ -> ì¼ê´„ì²˜ë¦¬orë‹¨ìˆœì§‘ê³„`í•˜ëŠ”ë°, ë‚´ë¶€ ë³€ìˆ˜ì˜ ì§‘ê³„ë¼ë©´ getterë¡œ ë³€í™˜í•´ì„œ ì§‘ê³„**

    - ê°™ì€í˜•ì„ ë¬¶ì„ ë•, `List.of( , , )`ë‚˜ `Steram.of(, , , )`

    ```java
    Stream.of(first, second)
        .mapToInt(it -> it.point())
        .sum();
    ```

    



##### ì¼ê´„ì²˜ë¦¬ê°€ 2ë²ˆì´ìƒ ë“±ì¥í•œë‹¤ë©´, ë¬´ì¡°ê±´ `List.of(, , )ë¡œ ë¬¶ì–´ë†“ê³  ë³€ìˆ˜ë¡œ ë½‘ì•„ë†“ê³ ` -> list.stream()ìœ¼ë¡œ ì¼ê´„ì²˜ë¦¬ ë§¤ë²ˆ ì ìš©í•œë‹¤.

```java
public static Object start(final Card first,
                           final Card second) {

    //1. ê°™ì€í˜•ì˜ [ì¼ê´„ì²˜ë¦¬/ë‹¨ìˆœì§‘ê³„]ê°€ 2ë²ˆì´ìƒ í•„ìš”í•  ë• -> ë¬´ì¡°ê±´ List.of()ë¡œ ì¼ë‹¨ ë¬¶ì–´ ë³€ìˆ˜ë¡œ ëº€ë‹¤.
    final List<Card> cards = List.of(first, second);

    //        final int sum = Stream.of(first, second)
    // ì¼ê´„ì²˜ë¦¬1: ë‚´ë¶€ë³€ìˆ˜ ë‹¨ìˆœì§‘ê³„
    final int sum = cards.stream()
        .mapToInt(it -> it.point())
        .sum();

    //        final boolean hasAce = Stream.of(first, second)
    // ì¼ê´„ì²˜ë¦¬2: ì¼ê´„ì²˜ë¦¬ë¡œ ë©”ì„¸ì§€ë³´ë‚´ê¸°
    final boolean hasAce = cards.stream()
        .anyMatch(Card::isAce);

    if (hasAce && sum == 11) {
        return new Blackjack();
    }

    return new Hit();
}
```



#### ë°˜ë³µë¬¸iterì™€ forEach

- `iter`

    ```java
    for (CarDto currentCar : currentCars) {
        System.out.println(currentCar.getName() + " : " + collectDash(currentCar.getPosition()));
    }
    ```

- `forEach`

    ```java
    currentCars.forEach(currentCar -> {
        System.out.println(currentCar.getName() + " : " + collectDash(currentCar.getPosition()));
    });
    ```

    

#### ë°˜ë³µë¬¸fori ê³¼ IntStream

- `fori`

    ```java
    StringBuilder track = new StringBuilder();
    for (int i = 0; i < position; i++) {
        track.append("-");
    }
    return track.toString();
    ```

- `Intstream`

    ```java
    IntStream.range(0, position)
        .forEach(i -> {
            track.append("-");
        });
    return track.toString();
    ```

    



#### ì§‘ê³„max( ìˆ«ìVO::compareTo )

- `ê°’ìœ¼ë¡œ ë³€í™˜`í•œ ë’¤ì— `.max()`ëŠ” ì¸ìì—†ì´ ë°”ë¡œ ì‚¬ìš©ê°€ëŠ¥

```java
this.cars.stream()
    .mapToInt(car -> car.toInt())
    .max()
    .orElseThrow(() -> new NoSuchElementException("ìµœëŒ€ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."));
```

- **ê°’ ê°ì²´ë¼ë¦¬ ë¹„êµëŠ” í•„ìš”ì¡°ê±´ì´ìˆë‹¤.**
    1. ìˆ«ìVOì—ì„œ Comparable<í´ë˜ìŠ¤> êµ¬í˜„
    2. VOë¡œì„œ ê¸°ë³¸ equals ê°€ì§€ê¸°
    3. compareTo ì˜¤ë²„ë¼ì´ë”©í›„ êµ¬í˜„ -> Integer.compare( , )
    4. streamì—ì„œëŠ” `.max( í´ë˜ìŠ¤::compareTo)`ë¡œ **ë¹„êµí•˜ë©´ì„œ ì§‘ê³„**

```java
//1. Comparable<> implí•˜ê³ 
implements Comparable<$CLASS_NAME$>

//2. ì˜¤ë²„ë¼ì´ë”© compareTo -> Integer.compare( this.ìˆ«ë³€.toInt() , o(ì¸ì).ìˆ«ë³€.toInt() );
return Integer.compare( this.$INT_VALUE$.toInt() , o.$INT_VALUE$.toInt());

//3. VOë¼ë©´ ê°’ê°™ìœ¼ë©´ ê°™ì€ê°ì²´ ë³´ì¥ìš© -> equals && hashCode ì˜¤ë²„ë¼ì´ë”©

//4. streamì—ì„œëŠ” .maxì§‘ê³„( í´ë˜ìŠ¤::compareTo )
cars.stream()
.max(Car::compareTo)
.orElseThrow(() -> new IllegalArgumentException());
```



##### ì°¸ê³ )  ì œë„¤ë¦­ë©”ì„œë“œ + reduceë¡œ max ì§‘ê³„

```java
private static <T extends Comparable<T>> T max(final List<T> list) {
    return list.stream()
        .reduce((a, b) -> a.compareTo(b) > 0 ? a : b)
        .get();
}
```





#### listí•„í„°ë§- filter ( -> ê°ì²´. t/fë°˜í™˜ë©”ì„œë“œ ì‚¬ìš© )

- ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ê²ƒë§Œ ê³¨ë¼ë‚´ì•¼í•œë©´, **`filter` + `ê°ì²´ì—ê²Œ ì‹œì¼œì„œ t/fë°˜í™˜`í•˜ë„ë¡ í•œë‹¤.** 

```java
this.cars.stream()
    .filter(car -> car.isSamePosition(maxPosition)) // í•„í„°ë¡œ ì¡°ê±´ë©”ì†Œë“œ ì°¸ì¸ ê²ƒë§Œ ê³¨ë¼ë‚´ê¸°
    .collect(Collectors.toList());
```





#### íŠ¹ì • ë¬¸ìì—´ì†ì„± joinning - (map+getString  -> joining)

```java
cars.stream()
    .map(car->car.getName())
   .collect(Collectors.joining(System.lineSeparator()));
```



#### ë§Œì¡±í•˜ëŠ” ì´ ê°¯ìˆ˜ ì¹´ìš´íŒ…(for+if+add ->) by filter.() + (ë‹¤ëª¨ì•„ì„œ) count()

```java
public int match(final Lotto other) {
    return (int) other.value.stream()
        .filter(it -> contains(it))
        .count();
}

public boolean contains(final LottoNumber number) {
    return value.contains(number);
}
}
```

```java
private int calculateAceCount() {
    return (int) playingCards.stream()
        .filter(PlayingCard::isAce)
        .count();
}
```



#### ì—­ìˆœ list

```java
List<Rank> ranks = Arrays.asList(Rank.values());
Collections.reverse(ranks);
```



#### ì—­ìˆœ stream With comparable ìƒì†

```java
.stream()
.sorted(Comparator.reverseOrder())
```





#### ëˆ„ì ì€ mapToType + .ì§‘ê³„ >> .reduce(ì´ˆê¸°ê°’, í•´ë‹¹Type::ì§‘ê³„í•¨ìˆ˜) ë” ê¹”ë”

```java
//ìˆ˜ì •ì „
return rankResults.entrySet().stream().map(Entry::getValue).reduce(0, Integer::sum)
    * Lotto.LOTTO_PURCHASE_MONEY;

//ìˆ˜ì •í›„
return rankResults.entrySet().stream()
    .mapToInt(Entry::getValue)
    .sum() * Lotto.LOTTO_PURCHASE_MONEY;
```







#### toSet() / toMap() ë“±... ë‹¤ë¥¸ ê²ƒìœ¼ë¡œë„ ê°€ëŠ¥

- set

```java
numbers.stream() // ìŠ¤íŠ¸ë¦¼ì„ ì—´ê³ 
        .map(Number::new) // ê°€ê³µí•˜ì—¬
        .collect(Collectors.toSet()); // ê²°ê³¼ë¥¼ ì…‹ìœ¼ë¡œ ë§Œë“ ë‹¤.
```

- map

```java
LOTTO_NUMBER_CACHE = IntStream.rangeClosed(MIN_LOTTO_NUMBER, MAX_LOTTO_NUMBER)
    .boxed()
    .collect(Collectors.toMap(
        number -> number, //Function.identity()
        LottoNumber::new
    ));
```

- mapì„ `ìê¸°ìì‹ ì„ key, 0ì„ ìƒìˆ˜ value`ìœ¼ë¡œ **ì´ˆê¸°í™”í•´ì„œ ìƒì„±**
    - it -> it : `Function.identity()`ë¡œ **ìê¸°ìì‹  ê·¸ëŒ€ë¡œ ë°˜í™˜** ì´ìš©ê°€ëŠ¥í•˜ë‚˜ë³´ë‹¤
    - it -> 0 : ìˆ«ìëŠ” 1ë‹¨ì–´ë¡œ ë°”ë¡œ ì•ˆë˜ë‚˜ë³´ë‹¤.

```java
private Map<Rank, Integer> emptyRankMap() {
    return Stream.of(Rank.values())
        .collect(toMap(Function.identity(), r -> 0));
}
```

- mapì„ **`ìê¸°ìì‹ ì„ key`  + `keyë³„(ê·¸ë£¹ë³„)ë¡œ ëˆ„ì `**

    ```java
    return lottos.getLottos()
        .stream()
        .map(winningLotto::getRankByLotto)
        .collect(groupingBy(identity(),
                            () -> new EnumMap<>(Rank.class),
                            summarizingLong(Rank::getPrize)));
    ```

    

- toMapìœ¼ë¡œ ë‹¤ë¥¸typeì˜ ë§µì„ ë§Œë“œë ¤ë©´ **3, 4ë²ˆì§¸ ì¸ì ë™ì‹œì— ì¶”ê°€í•´ì¤˜ì•¼í•œë‹¤.**

    ```java
    public static Map<Player, Integer> from2(final Players players) {
        return players.getGamblers()
            .stream()
            .collect(Collectors.toMap(
                Function.identity(),
                gambler -> caculateProfit(players, gambler),
                (x, y) -> y,  // 3ë²ˆì¬ì—ëŠ”.. ì˜¬ë“œ,ë‰´ ì¤‘ì— ë‰´ë¥¼ ì„ íƒ?? ë¨¸ì§€?
                LinkedHashMap::new) // 4ë²ˆì§¸ì—.. ë§Œë“¤ íƒ€ì…
                    );
    }
    ```

    

#### containsì™€ anyMatch or noneMatch & equals(ê°™ì€ê²Œ & í•˜ë‚˜ë¼ë„ ìˆëƒ)

- **`ê°ì²´ ì† íŠ¹ì •í•„ë“œ`ì— ëŒ€í•œ `contains`(boolean) -> stream + `map(í•„ë“œ)` + `anyMatch & equals`** 

    - ê°ì²´ ì† í•„ë“œê°€ ì•„ë‹ˆë¼ ê°ì²´list contains ê°ì²´ë¼ë©´

        - **stream + anyMatch & equals(í•˜ë‚˜ë¼ë„ ê°™ì€ê²Œ ìˆëƒ)**

        ```java
        private boolean containsSection(Section section) {
            return sections.stream()
                .anyMatch(value -> value.equals(section));
        }
        ```

        

    - streamì„ ì•ˆì“´ë‹¤ë©´

        - ë¹ˆlist add getterë¡œ `í•„ë“œlist` -> `contains ( ê°ì²´.getter )`

    - streamì„ ì“´ë‹¤ë©´

        - `map`ìœ¼ë¡œ í•„ë“œlistë¡œ ë³€í™˜  -> **ê°™ì€ê²Œ í•˜ë‚˜ë¼ë„ ìˆë‚˜ `anyMatch + equals`**

    - **`! contains`ë¼ë©´**

        - `map`ìœ¼ë¡œ í•„ë“œlistë¡œ ë³€í™˜ -> **í•˜ë‚˜ë¼ë„ ê°™ì€ê²Œ ì—†ì–´ì•¼ `noneMatch + equals`**

        ```java
        private boolean isFirstSection(final Section section) {
            return value.stream()
                .map(Section::getDownStationId)
                .noneMatch(downStationId -> section.getUpStationId().equals(downStationId));
            //        return !getDownStationIds().contains(section.getUpStationId());
        }
        
        /*    private List<Long> getDownStationIds() {
                return value.stream()
                    .map(Section::getDownStationId)
                    .collect(Collectors.toList());
            }*/
        ```




##### ì¤‘ë³µê²€ì‚¬ë„ containsì™€ ê°™ë‹¤. ê°™ì€ê²Œ(equals) í•˜ë‚˜ë¼ë„ ìˆëƒ(anyMatch)

- ê°™ì€ê²Œ ìˆìœ¼ë©´ ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ”ë°, ifPresent()ëŠ” ì˜ˆì™¸ë˜ì§€ëŠ” ìš©ì´ ì•„ë‹ˆë‹ˆ ì¡°ì‹¬í•˜ì

    - ì˜ëª»ëœ ì˜ˆ

        ```java
        private void validateDuplicateSection(final Section section) {
            values.stream()
                .filter(value -> value.isSameSection(section))
                .findAny()
                .ifPresent(value -> {
                    throw new SectionCreateException(SECTION_ALREADY_EXIST_MESSAGE);
                });
        }
        ```

    - anyMatchë¥¼ booleanìœ¼ë¡œ ë°›ì•„ì„œ ifë¬¸ì— ê±¸ì–´ ì²˜ë¦¬

        ```java
        private void validateDuplicateSection(final Section section) {
            boolean exist = values.stream()
                .anyMatch(value -> value.isSameSection(section));
            if (exist) {
                throw new SectionCreateException(SECTION_NOT_CONNECT_MESSAGE);
            }
        }
        ```



##### íŠ¹ì •ë¡œì§ì— í•´ë‹¹í•˜ëŠ” ê²ƒì´ ì—†ëŠëƒë„ containsì™€ ê°™ë‹¤. í•´ë‹¹í•˜ëŠ” ê²Œ(compareMethod) í•˜ë‚˜ë„ ì—†ë‚˜(noneMatch)

- **ë¹„êµë©”ì„œë“œëŠ” poisitiveí•˜ê²Œ ì‘ì„±í•˜ê³  -> í•˜ë‚˜ë„ ì—†ëŠëƒì˜ ë¶€ì •ì–´ë¥¼ noneMatchë¡œ í•œë‹¤**

```java
private void validateSectionConnect(final Section section) {
    boolean isNotConnected = values.stream()
        .noneMatch(value -> value.haveStation(section));
    if (isNotConnected) {
        throw new SectionCreateException(SECTION_NOT_CONNECT_MESSAGE);
    }
}

```



#### í•´ë‹¹(í¬í•¨)í•˜ëŠ”ê²Œ ìˆìœ¼ë©´ -> ì°¾ì•„ì„œ -> íŠ¹ì • ë¡œì§ ìˆ˜í–‰ê¹Œì§€ ì§„í–‰ëœë‹¤ë©´, `anyMatch + ë¹„êµë©”ì„œë“œ`ê°€ ì•„ë‹ˆë¼ `filter + findAny ì°¾ì•„ë†“ê³  -> ifPresent( -> ìˆ˜í–‰ë©”ì„œë“œ() )`ë¡œ ë‹¤ë¥´ê²Œ ì‘ì„±í•œë‹¤.

- **`í•´ë‹¹í•˜ëŠ”ê²Œ ìˆëŠëƒ`ë§Œ ë¬¼ì–´ë³´ê³  ëë‚œë‹¤(ì˜ˆì™¸ ë˜ì§€ê¸°, ì¡°ê±´ë¬¸ìš©)**ë©´

    - `anyMatch/noneMatch` -> `ë¹„êµë©”ì„œë“œ/equals`

- **`í•´ë‹¹í•˜ëŠ”ê²Œ ìˆìœ¼ë©´ -> (ì°¾ì•„ì„œ) -> ìˆ˜í–‰`í•´ë¼**ë©´

    - `filter & ë¹„êµë©”ì„œë“œ/equals` + `findAny()` + `ifPresent( -> ìˆ˜í–‰ë©”ì„œë“œ())`

    ```java
    private void cutInSection(final Section section) {
        values.stream()
            .filter(value -> value.isSameUpStation(section.getUpStation())
                    || value.isSameDownStation(section.getDownStation()))
            .findAny()
            .ifPresent(foundSection -> updateCutInSection(section, foundSection));
    }
    ```

    





### ë¡œë˜

#### shuffleí›„   subList -> .limit(6)ìœ¼ë¡œ ë¥¼ í†µí•œ  ëœë¤ì¶”ì¶œ êµ¬í˜„

```java
public static Lotto issueLotto() {
    Collections.shuffle(LOTTO_NUMBERS);
    return new Lotto(LOTTO_NUMBERS.stream()
                     .limit(6)
                     .sorted()
                     .collect(Collectors.toList()));
}
```





#### IntStream + boxed(Integer for Map ì œë„¤ë¦­) toMap( it -> key, value)ìœ¼ë¡œ <ìˆ«ì, ìˆ«ìVO>ë§¤í•‘ Map ë§Œë“¤ê¸°

- .map() ì—†ì´

- `.boxed()` ìˆ˜ë™ í•„ìˆ˜

- toMap( -> a, b)ì˜ **2ë²ˆì§¸ Value ìë¦¬ì— ìƒì„±ìí˜¸ì¶œ -> ë©”ì„œë“œíŒŒë¼ë¯¸í„° í•„ìˆ˜!**

    ![image-20220308231647756](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220308231647756.png)
    ![image-20220308231703337](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220308231703337.png)

```java
public synchronized static LottoNumber valueOf(final int number) {
    checkNumberRightRange(number);
    if (LOTTO_NUMBER_CACHE == null) {
        LOTTO_NUMBER_CACHE = IntStream.rangeClosed(MIN_LOTTO_NUMBER, MAX_LOTTO_NUMBER)
            .boxed()
            .collect(Collectors.toMap(lottoNumber -> lottoNumber, LottoNumber::new));
    }
    return LOTTO_NUMBER_CACHE.get(number);
}
```



#### ê°€ë³€ ë³€ìˆ˜ ì œê±° -> ì•„ì§ listê°€ ì•„ë‹Œ [streamìƒíƒœë¡œ ëª¨ì•„ì„œ] ->  mapë³€í™˜ ëª»í•œ ê²½ìš° -> ëª¨ì•„ì„œ listë§Œë“¤ë©´ì„œ map collectAndThen( toList(), ë³€í™˜ë©”ì„œë“œ)

- stream + stream -> concat í•˜ì—¬ mapí•  ê¸°íšŒë¥¼ ë†“ì¹œ ì²´ `.collect( toList())` í•˜ì—¬ ì´í›„ **ë˜ ê°œë³„ stream + map**í•´ì¤˜ì•¼í•œë‹¤? -> ë°”ë¡œ í•  ìˆ˜ ìˆë‹¤.
    - **2stream ì„ 1ê°œ listë¡œ ë³€í™˜í•´ì„œ ëª¨ìœ¼ê³ ** -> **í¬ì¥**ê¹Œì§€ í•  ìˆ˜ ìˆë‹¤.!!
    - ê¸°ì¡´list.stream() + ìƒˆlist.stream()  -> Stream.concat() -> **collect( `collectingAndThen( toList(), í¬ì¥ìƒì„±ì::new )`**

```java
public Lottoes combine(Lottoes other) {
    List<Lotto> result = new ArrayList<>();
    result.addAll(lottoes);
    result.addAll(other.lottoes);
    return new Lottoes(result);
}

// ë³€í™˜í›„
public Lottoes combine(Lottoes other) {
    return Stream.concat(lottoes.stream(), other.lottoes.stream())
        .collect(collectingAndThen(toList(), Lottoes::new));
}
```









### ë¸”ë™ì­

#### for for ê°ì²´ ìƒì„± -> stream map -> stream map -> ì•ì— mapì„ flatmap -> toCollection( ëª¨ì€ ê²°ê³¼ë¬¼stream -> new ì›í•˜ëŠ” ì»¬ë ‰ì…˜ ìƒì„±) 

- `ì•ì— ê²ƒ suit 1ê°œë‹¹` -> ì—¬ëŸ¬ denomination.values()ë“¤ì´   `ì—¬ëŸ¬ê°œì˜ ê²°ê³¼ë¬¼`ì„ ë§Œë“¤ ê²ƒì´ë‹¤.
- **`ì•ì— ê²ƒë“¤` suit_1 + suit_2 + ...  -> `ê°ê°ì— í•´ë‹¹í•˜ëŠ” ê²°ê³¼ë¬¼ë“¤`ì„ `.flatmap()`ìœ¼ë¡œ `ë‹¤ ëª¨ì€ë‹¤`**
- **ëª¨ì•„ì§„ streamì„ `toCollection(  ->  )`ë¡œ ë˜ ì›í•˜ëŠ” ì»¬ë ‰ì…˜(Stack)ìœ¼ë¡œ ë³€ê²½ìƒì„±**

```java
Stack<PlayingCard> playingCards = Arrays.stream(Suit.values())
	//.map(suit -> Arrays.stream(Denomination.values())
	.flatMap(suit -> Arrays.stream(Denomination.values())
	.map(denomination -> PlayingCard.of(suit, denomination)))
	.collect(Collectors.toCollection(Stack::new));

Collections.shuffle(playingCards);
this.playingCards = playingCards;
```





#### Count Map ìƒì„±



#####  CountMap01 EnumMap  -> ê²°ê³¼listë¥¼ [ ì§ì ‘ 0 ì´ˆê¸°í™”í›„ map.putì¹´ìš´íŒ…]

- **ì œí•œëœ keyê°’ë“¤ì„ ë„ëŠ” Enum.values().stream + forEach put( , 0) + ê²°ê³¼ListëŒë©´ì„œ ê°œë³„ +1**

```java
private final EnumMap<Rank, Integer> result = new EnumMap<>(Rank.class);

// ì¹´ìš´íŠ¸ 0ìœ¼ë¡œ ì´ˆê¸°í™”
{
    Arrays.stream(Rank.values()).forEach(rank -> result.put(rank, 0));
}


// ë‹¨ì¼keyë¥¼ ëŒë©´ì„œ
result.put(rankPrize, result.getOrDefault(rankPrize, 0) + 1);
```





##### [ì¶”ì²œ] CountMap02 EnumMap  -> ê²°ê³¼listë¥¼  [ì´ˆê¸°í™”ì—†ì´ map.merge]

- **ë¯¸ë¦¬ 0 ì´ˆê¸°í™” ì—†ì´ `ì•Œì•„ì„œ ì§ì „value(ì—†ìœ¼ë©´ 0ë¶€í„°) ëˆ„ì `í•´ì£¼ëŠ” ->  `map.merge( ê°ì²´key, ëˆ„ì í•´ë„£ì„ê°’, Integer.sum()ìœ¼ë¡œ ê¸°ì¡´valueì™€ ëˆ„ì ë°©ë²• Bifunction )`**


```java
result.merge(rank, 1, (before, after) -> Integer.sum(before, after))
```

```java
final List<Rank> results = lottos.stream()
    .map(lotto -> match(lotto, winningLotto))
    .collect(Collectors.toList());

final EnumMap<Rank, Integer> result = new EnumMap<>(Rank.class);

results
    .forEach(rank -> result.merge(rank, 1, (before, after) -> Integer.sum(before, after)));
```

```java
private Result(final LottoGroup lottos, final WinningLotto winningLotto) {
    for (Lotto lotto : lottos.get()) {
        Rank rank = Rank.of(lotto.countSameNum(winningLotto), lotto.contains(winningLotto.getBonusNumber()));
        value.merge(rank, 1, Integer::sum);
    }
}
```





##### [ì¶”ì²œ] CountMap03 -> ì¼ê¸‰vsë‹¨ì¼ [keyì²˜ë¦¬ì™€ ì´ˆê¸°í™”ì—†ì´ countingì„ ë™ì‹œì— ] by Collectors.groupingBy

- ì¼ê¸‰vsë‹¨ì¼ì˜ ê²°ê³¼ê°’list ë°”ë¡œ ë½‘ì€ ë’¤ ì²˜ë¦¬í•˜ëŠ” ëŒ€ì‹   `ì²˜ë¦¬ + countingì„ ë™ì‹œì— ` -> 
    - **groupingBy(ë‹¨ì¼vsë‹¨ì¼ë¡œ ê°ì²´keyë¡œì§, summingInt( count -> 1))ìœ¼ë¡œ í•œë²ˆì— ë¡œì§ì²˜ë¦¬ + Mapë§Œë“¤ê¸°**

```java
this.value = lottos.stream() // ì¼ê¸‰vsë‹¨ì¼ -> ë‹¨ì¼vsë‹¨ì¼ -> ê²°ê³¼ List 
    .collect(Collectors.groupingBy(
        lotto -> match(lotto, winningLotto), // ë‹¨ì¼vsë‹¨ì¼ë¡œ ê²°ê³¼ê°ì²´ 1ê°œ
        Collectors.summingInt(count -> 1))); // ì—†ìœ¼ë©´ 0ë¶€í„° 1ì”© countëˆ„ì ì‹œí‚´
```



- **`ë§µ íƒ€ì… ì§€ì • ê°€ëŠ¥`**

```java
final EnumMap<GameResult, Integer> dealerResult = gamblers.stream()
    .collect(Collectors.groupingBy(
        gambler -> getResultPlayer(dealer, gamblerResult, gambler),
        () -> new EnumMap<>(GameResult.class), // Mapíƒ€ì… ê°€ìš´ë°ì„œ ì§€ì •
        Collectors.summingInt(count -> 1)
    ));
```







#### map ëŒì•„ì„œ ì²˜ë¦¬í•˜ê¸°

#####  keyë§Œ == 1ê°œë§Œ í•„ìš”í•œ ê²½ìš° : `map.keySet()`.stream().map() -> map.get(key)

- keyê°ì²´ë§Œ ëŒê¸° ë•Œë¬¸ì— -> **map(value)ì„ ë‚´ë¶€ì—ì„œ ë”°ë¡œ í˜¸ì¶œ(map.get( `ë„ëŠ” key`)**í•´ì•¼í•œë‹¤.
    - keyê°€ getterë¥¼ ì†Œì§€í•œ ê°ì²´ì¸ ê²½ìš°, `ê°ì²´key ìì²´ì˜ ê°’`ê³¼ mapì— ë°•í˜€ìˆë˜ `keyì˜ ê°’`ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

```java
public long getPrize() {
    long prize = 0;
    for (Rank rank : value.keySet()) {
        prize += (long) rank.getPrize() * value.get(rank);
    }
    return prize;
}
```



#####  valueë§Œ == 1ê°œë§Œ í•„ìš”í•œ ê²½ìš° : `map.values()`.stream().map() -> map.get(key)

```java
private static long getTotalReturnByLottoResult(Map<Rank, LongSummaryStatistics> lottoResult) {
    return lottoResult.values()
        .stream()
        .mapToLong(LongSummaryStatistics::getSum)
        .sum();
}
```



##### key+valueê°€ ë‘˜ë‹¤ í•„ìš”í•œ ê²½ìš°: `map.entrySet()`.stream().map()  ->  it.getKey + it.getValue

- streamìƒ 1ê°œ ê°’ì´ key, valueë¥¼ ë‹¤ ê°€ì§€ê³  ìˆìœ¼ë©°, `mapì„ ë”°ë¡œ í˜¸ì¶œí•  í•„ìš” ì—†ì´ ë½‘ì•„ì„œ ì“°`ë©´ ëœë‹¤.
    - cf) Longíƒ€ì…ì˜ ëˆ„ì ì€ `.reduce( 0L` ë¡œ ì‹œì‘í•˜ê³ , ì§‘ê³„í•¨ìˆ˜ìë¦¬ì—ëŠ” `Long::xxx)`ë¥¼ ë„£ì–´ì£¼ë©´ ëœë‹¤.

```java
private Long calculateTotalReward() {
    return rankResults.entrySet()
        .stream()
        .map(result -> Rank.calculateMoney(result.getKey(), result.getValue()))
        .reduce(0L, Long::sum);
}
```

- **`mapToTypeí•œ ë’¤, ì •í•´ì§„ .ì§‘ê³„ë©”ì„œë“œ()` ì“°ëŠ”ê²Œ ì ¤ í¸í•˜ë‹¤. ì–´ëŠ ë°©ì‹ì´ë“  defaultê°’ì€ 0ìœ¼ë¡œ ì³ì¤€ë‹¤.**

```java
//ìš”ë ‡ê²Œë„ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë„¤ìš”ğŸ™‚

public double getRateOfProfit(Money money) {
        long totalMoney = result.entrySet()
                .stream()
                .mapToLong(entry -> entry.getKey().multiply(entry.getValue()))
                .sum();
        return money.getRateOfProfit(totalMoney);
}
```



#### mapì„ ëŒë©°, ëˆ„ì í•˜ê¸°

##### int (mapToInt -> sum() )

```java
value.entrySet()
    .stream()
    .mapToInt(Entry::getValue)
    .sum() * Lotto.LOTTO_PURCHASE_MONEY;
```



##### long with Enum ( map -> reduce( 0L , ) )

```java
rankResults.entrySet()
    .stream()
    .map(result -> Rank.calculateMoney(result.getKey(), result.getValue()))            
    .reduce(0L, Long::sum);
```

```java
//Rank
public static long calculateMoney(final Rank currentRank, final long count) {
    return currentRank.reward * count;
}
```







#### ëˆ„ì  ê³„ì‚°( int vs Long )

##### [ì¶”ì²œ] ëˆ„ì  ì—°ì‚°ì´ ë¯¸ë¦¬ ì •í•´ì§„ ê³„ì‚°: `mapToType( -> )`  -> `.sum()`

1. **ìµœì¢…ê²°ê³¼ê°€ `21ì–µì´ ë„˜ëƒ ì•ˆë„˜ëƒ`ì—** ë”°ë¼ì„œ ì• ì´ˆì— **ìë£Œí˜•**ì„ **`long`ìœ¼ë¡œ ì„ ì–¸**í•œë‹¤.

    ```java
    public enum Rank {
    
        FIRST(2_000_000_000, 6),
        SECOND(30_000_000, 5),
        THIRD(1_500_000, 5),
        FOURTH(50_000, 4),
        FIFTH(5_000, 3),
        NOT_THING(0, 0),
        ;
    
        private final long reward;
        private final int hitCounts;
    
    ```

    

    - ë‚˜ëŠ” ë‹¨ì¼ ê°’ì´ 21ì–µì´ ì•ˆë„˜ì–´ì„œ default intë¡œ ì„ ì–¸í–ˆì§€ë§Œ, **ëˆ„ì í•©ì—ì„œ 21ì–µ ë„˜ì„ ìˆ˜ ìˆìœ¼ë‹ˆ ë¯¸ë¦¬ ìë£Œí˜•ì„ `long`ìœ¼ë¡œ í•´ì£¼ì**

        - ë‚´ê°€ ìµœì¢…ê²°ê³¼ ê°„ê³¼ í•œ ê²ƒ

            ![image-20220310174619640](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220310174619640.png)

        - ìµœì¢…ê²°ê³¼ê°€ 21ì–µì´ ë„˜ì„ ê°€ëŠ¥ì„± -> **ë¯¸ë¦¬ longíƒ€ì…ìœ¼ë¡œ ì„ ì–¸í•´ì¤€ ê²½ìš°**
            ![image-20220310174648430](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220310174648430.png)

        - ì°¸ê³ ) longíƒ€ì… í‘œê¸°ë¥¼ ìœ„í•´ `L`ë¶™ì¼ ê²½ìš° `_` ëŠìŒ í‘œì‹œ ëª»ë„£ëŠ”ë‹¤.
            ![image-20220310174755764](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220310174755764.png)
            ![image-20220310174808334](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220310174808334.png)

            

    2. ë©”ì„œë“œ returntypeë„ longìœ¼ë¡œ ìë™ìœ¼ë¡œ ëœë‹¤.

        ```java
        public long getPrize(final Integer count) {
            return this.prize * count;
        }
        ```

    3. ê³„ì‚°ë„ defaultê°’ ìƒê°í•˜ì§€ë§ê³  ëˆ„ì ê³„ì‚°ì„ ì •í•´ì§„ `.sum()`ë¡œ ì‹œí‚¤ë©´ ëœë‹¤.

        ```java
        public long getPrize() {
            return value.entrySet()
                .stream()
                .filter(result -> !result.equals(Rank.OUT))
                .mapToLong(it -> it.getKey().getPrize(it.getValue()))
                .sum();
            //.reduce(0, Integer::sum);
        }
        ```

        

    

##### ëˆ„ì  ì—°ì‚°ì„ ì»¤ìŠ¤í…€ìœ¼ë¡œ í•  ê²½ìš°, `map( -> ) .reduce( defaultê°’ , Long::sum)` -> ë¶ˆí¸

1. ë³€í™˜ë˜ëŠ” íƒ€ì…ì´ í‘œê¸°ëŠ” ì•ˆë˜ì§€ë§Œ, **typeì´ ë§ì§€ ì•ŠëŠ” ê²½ìš°, ì•Œì•„ì„œ `ëˆ„ì ì—°ì‚° ë©”ì„œë“œ ìë¦¬ì—ì„œ ì—ëŸ¬`**

    ![image-20220310175244521](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220310175244521.png)
    ![image-20220310175258166](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220310175258166.png)

    ![image-20220310175303609](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220310175303609.png)

    









##### [ë¹„ì¶”] for ëˆ„ì  + ë§¤ë²ˆ long í˜•ë³€í™˜í•˜ì—¬ +=ëˆ„ì 

- ê·¸ëƒ¥ ìë£Œí˜• ìì²´ë¥¼ 1ê°œë¥¼ longìœ¼ë¡œ ì„ ì–¸í–ˆì–´ë„ ë¨.

```java
public long getPrize() {
    long prize = 0;
    for (Rank rank : value.keySet()) {
        prize += (long) rank.getPrize() * value.get(rank);
    }
    return prize;
}
```





### ë¡œë˜

#### [ëˆ„ì ë  ê°’ì„ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œ]ë¥¼ ë°›ì•„ ê°€ë³€ë³€ìˆ˜ ëˆ„ì ì„ stream + map + sumìœ¼ë¡œ ëˆ„ì í•˜ê¸°

![image-20220729170553637](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220729170553637.png)

4. **ì™¸ì ìœ¼ë¡œ ê°€ë³€ë³€ìˆ˜ì˜ ëˆ„ì ì€ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.**

   - **ì¼ë‹¨ ëˆ„ì ë  ë¡œì§ì€ ë¦¬íŒ©í† ë§í•´ì„œ 1ê°œì˜ ë©”ì„œë“œë¡œ ëª¨ì€ë‹¤.**

     ![6e67ff05-fca2-4df0-8483-9b963b678a4a](https://raw.githubusercontent.com/is3js/screenshots/main/6e67ff05-fca2-4df0-8483-9b963b678a4a.gif)

     ![image-20220729171257386](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220729171257386.png)

   - streamìœ¼ë¡œ ê°€ë³€ë³€ìˆ˜ì— **ê°’ì„ ëˆ„ì **í•œë‹¤ë©´

     - ì›ì‹œê°’ ëˆ„ì ì´ë©´ .reduce(0 , ì—°ì‚°ëŒë‹¤ì‹ )
     - **ë³€í™˜ëœ ê°’ ëˆ„ì ì´ë©´, mapToXXX( ) -> .sum()ì„ ë•Œë¦¬ë©´ ëœë‹¤.**

     ![a5c8fd28-0e8f-4b27-9c45-50e45d6414ce](https://raw.githubusercontent.com/is3js/screenshots/main/a5c8fd28-0e8f-4b27-9c45-50e45d6414ce.gif)

     ![image-20220729174041392](https://raw.githubusercontent.com/is3js/screenshots/main/image-20220729174041392.png)



### ì²´ìŠ¤

#### enumì—ì„œ filter(í•´ë‹¹ë¬¸ìì—´ í™•ì¸) + orElseThrowë¡œ enum.of( input ) ê²€ì¦í¬í•¨í•´ì„œ ì°¾ê¸°

##### ë¬¸ìì—´ë¡œ í™•ì¸ì‹œ ì •ê·œì‹(ë‹¤ equalsì¸ë° í•˜ë‚˜ë§Œ startsWith -> ì •ê·œì‹ ë¹„êµë¡œ í†µì¼) ì´ í•„ìš”í•˜ë©´ ê·¸ê²ƒìœ¼ë¡œ filter

![image-20220330111558955](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220330111558955.png)

```java
public static Command of(final String inputCommand, ChessGame chessGame) {
// webë“±ìœ¼ë¡œ ê°ˆ ê²ƒ ê°™ìœ¼ë©´, inputViewëŒ€ì‹  ë¹ˆê°’ nullê²€ì‚¬ë¥¼ ì—¬ê¸°ë¡œ
    
//    if (inputCommand.startsWith(MOVE.value)) {
//        return new Move(chessGame);
//    }
    return Arrays.stream(ChessGameCommand.values())
//        .filter(it -> it.value.equals(inputCommand))
        .filter(it -> Pattern.matches(it.value, inputCommand))
        .map(command -> command.function.apply(chessGame))
        .findFirst()
        .orElseThrow(() -> new IllegalArgumentException(WRONG_COMMAND_MESSAGE));
}

```



##### ì¼ë°˜ ì˜¤ë¦¬

![image-20220330111748439](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220330111748439.png)

```java
public enum Command {

    START(Pattern.compile("start")),
    MOVE(Pattern.compile("move [a-h][1-8] [a-h][1-8]")),
    STATUS(Pattern.compile("status")),
    END(Pattern.compile("end")),
    ;

    Command(final Pattern commandPattern) {
        this.commandPattern = commandPattern;
    }

    public static Command toCommand(String input) {
        Objects.requireNonNull(input, "commandëŠ” nullì´ ë“¤ì–´ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return Arrays.stream(values())
                .filter(command -> isMatchPattern(command, input))
                .findAny()
                .orElseThrow(() -> new IllegalArgumentException("ì˜¬ë°”ë¥¸ ëª…ë ¹ì–´ê°€ ì•„ë‹™ë‹ˆë‹¤."));
    }

    private static boolean isMatchPattern(Command command, String input) {
        return command.commandPattern.matcher(input).find();
    }
```



#### ë¬¸ìì—´ splitëœ ê²ƒì„ skipìœ¼ë¡œ ì²˜ë¦¬

- ì—†ì—ˆë‹¤ë©´, ê°œë³„ substringí–ˆì–´ì•¼í•¨

    ```java
        public static Positions from(final String command) {
            return new Positions(Arrays.stream(command.split(SPLIT_DELIMITER))
                .skip(1) // [move a2 a4]ì—ì„œ -> [a2, a4]ë§Œ ì¶”ì¶œ
                .map(Position::from)
                .collect(Collectors.toList()));
        }
    ```

    

#### noneMatch/ allMatch -> (ë‹¤ëª¨ì•˜ëŠ”ë°) íŠ¹ì •ì¡°ê±´ì€ í•˜ë‚˜ë„ ì—†ì–´ì•¼í•œë‹¤ /  (ë‹¤ëª¨ì•˜ëŠ”ë°) ëª¨ë‘ ë§Œì¡±í•´ì•¼í•œë‹¤. or [ë°°ë°˜ì¡°ê±´ìœ¼ë¡œì„œ ë‘˜ì¤‘ì— í•œìª½ë§Œ] íŠ¹ì •ì¡°ê±´ë§Œ ì¡´ì¬í•´ì•¼í•œë‹¤.

```java
// kingë“¤ì„ ë‹¤ ëª¨ì•˜ëŠ”ë°, íŠ¹ì •ì¡°ê±´ (blackì¸ë†ˆì€) í•˜ë‚˜ë„ ì—†ì–´ì•¼í•œë‹¤
public boolean hasBlackKingCaptured() {
    return collectKing().stream()
        .noneMatch(Piece::isBlack);
}

// kingë“¤ì„ ë‹¤ ëª¨ì•˜ëŠ”ë°, whiteëŠ” ì—†ì–´ì•¼í•œë‹¤ -> ë‘˜ì¤‘ì— blackë§Œ ì¡´ì¬í•´ì•¼í•œë‹¤
public boolean hasWhiteKingCaptured() {
    return collectKing().stream()
        .allMatch(Piece::isBlack);
}
```







### ì§€í•˜ì²  ê²½ë¡œ

#### groupingByë¡œ ì¼ê¸‰ì»¬ë ‰ì…˜ì„ í•˜ìœ„ ê°ì²´ í•„ë“œë¡œ ê°€ì§€ëŠ” ë„ë©”ì¸ì˜ findAll() ì²˜ë¦¬í•˜ê¸°

- ìƒí™©

    - Line ë„ë©”ì¸ì— responseìš© í•˜ìœ„ ë„ë©”ì¸ Sectionsë¥¼ sql joinìœ¼ë¡œ ë¶™ì¼ ê²½ìš°

    - ë‹¨ê±´ ì¡°íšŒ(findById)ì„ì—ë„, Line(pk) <---left join--- Section(fk)ì‹œ lineì— ëŒ€í•´ì„œëŠ” 1xmê°œì˜ ë°ì´í„°ê°€ ìƒê¸´ë‹¤.

        ![image-20220530221725105](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220530221725105.png)

- í•´ê²°

    1. sql joinìœ¼ë¡œ lineì˜ ë‹¨ê±´ ì¡°íšŒ `findById`ì˜ selectì ˆì— sectionì •ë³´ë¥¼ ë¶™ì—¬ë„£ëŠ”ë‹¤.
        ![image-20220530221924421](https://raw.githubusercontent.com/is2js/screenshots/main/image-20220530221924421.png)

    2. `queryForList`ë¥¼ í†µí•´ **ë‹¨ê±´ ì¡°íšŒì„ì—ë„ ì—¬ëŸ¬ê°œ ìƒê¸°ëŠ” rowsë“¤ì„ Mapìœ¼ë¡œ ë°˜í™˜**ë°›ê³  ë‚œ ë’¤
        1. 

