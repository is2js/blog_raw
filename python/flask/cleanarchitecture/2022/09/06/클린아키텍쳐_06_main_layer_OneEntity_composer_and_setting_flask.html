<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>클린아키텍쳐 06 Main layer와 OneEntity Composer, Flask 세팅 | 돌범텤놑</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="클린아키텍쳐 06 Main layer와 OneEntity Composer, Flask 세팅" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="python clean architecture" />
<meta property="og:description" content="python clean architecture" />
<link rel="canonical" href="blog.chojaeseong.com/python/flask/cleanarchitecture/2022/09/06/%ED%81%B4%EB%A6%B0%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90_06_main_layer_OneEntity_composer_and_setting_flask.html" />
<meta property="og:url" content="blog.chojaeseong.com/python/flask/cleanarchitecture/2022/09/06/%ED%81%B4%EB%A6%B0%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90_06_main_layer_OneEntity_composer_and_setting_flask.html" />
<meta property="og:site_name" content="돌범텤놑" />
<meta property="og:image" content="blog.chojaeseong.com/images/posts/python.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-06T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2022-09-06T00:00:00-05:00","url":"blog.chojaeseong.com/python/flask/cleanarchitecture/2022/09/06/%ED%81%B4%EB%A6%B0%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90_06_main_layer_OneEntity_composer_and_setting_flask.html","@type":"BlogPosting","image":"blog.chojaeseong.com/images/posts/python.png","headline":"클린아키텍쳐 06 Main layer와 OneEntity Composer, Flask 세팅","dateModified":"2022-09-06T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"blog.chojaeseong.com/python/flask/cleanarchitecture/2022/09/06/%ED%81%B4%EB%A6%B0%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90_06_main_layer_OneEntity_composer_and_setting_flask.html"},"description":"python clean architecture","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<!-- 폰트추가를 위한 link태그 삽입 -->
  <!-- 폰트1:  기본 spoqa 웹폰트 -->
  <!-- css에서 * {} 다 뒤집어씀. -->
  <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css' rel='stylesheet' type='text/css'>
  <!-- 폰트2:  블로그 제목들 sunflower 웹폰트 -->
  <!-- 쥬피터 등 포스트 내부 글자 h1, h2 제목은 sunflower체 도입 -->
  <link href="//fonts.googleapis.com/css?family=Sunflower:300,500,700" rel="stylesheet"> 

  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="blog.chojaeseong.com/feed.xml" title="돌범텤놑" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">돌범텤놑</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">클린아키텍쳐 06 Main layer와 OneEntity Composer, Flask 세팅</h1><p class="page-description">python clean architecture</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-09-06T00:00:00-05:00" itemprop="datePublished">
        Sep 6, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#flask">flask</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#cleanarchitecture">cleanarchitecture</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!-- toc가 먼저 나오므로 h3로 안내하기 -->
    <h3>📜 제목으로 보기</h3>
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#클린-아키텍쳐-6장">클린 아키텍쳐 6장</a>
<ul>
<li class="toc-entry toc-h2"><a href="#1-main-layer">1 Main layer</a>
<ul>
<li class="toc-entry toc-h3"><a href="#01-src-main-폴더-및-init-생성">01 src&gt; main 폴더 및 init 생성</a></li>
<li class="toc-entry toc-h3"><a href="#02-srcmain-composer--adapterconfigsroutesinterface-폴더-및-init생성">02 src&gt;main&gt; composer + adapter/configs/routes/interface 폴더 및 init생성</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#2-interface-controller의-interface로서-routeinterface-정의하기">2 interface&gt; Controller의 Interface로서 RouteInterface 정의하기</a>
<ul>
<li class="toc-entry toc-h3"><a href="#01-maininterfaceroutepy--init-생성하고-routeinterface정의하기">01 main&gt;interface&gt;route.py + init 생성하고 RouteInterface정의하기</a>
<ul>
<li class="toc-entry toc-h4"><a href="#route는-controller인터페이스로서-httprequest-input---httpresponse-output의-route-method로-정의한다">Route는 controller인터페이스로서, HttpRequest Input -&gt; HttpResponse Output의 route method로 정의한다.</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#02-모든-controller는-routeinterface를-상속하고-controller의-메서드명-handle---route로-변경해준다">02 모든 Controller는 RouteInterface를 상속하고, controller의 메서드명 handle -&gt; route로 변경해준다.</a></li>
<li class="toc-entry toc-h3"><a href="#03-코드-수정후-확인은-pytest--vs-전역으로-해서-검사한다">03 코드 수정후 확인은 pytest -vs 전역으로 해서 검사한다</a></li>
<li class="toc-entry toc-h3"><a href="#04-commit---interface추가는-feat보다는-improve로">04 commit -&gt; interface추가는 feat:보다는 improve:로??</a></li>
<li class="toc-entry toc-h3"><a href="#05-생략된-controller-및-spy-추가">05 생략된 controller 및 Spy 추가</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#3-composer-use_case별-controller객체route객체를-반환해주는-composer메서드-구현">3 composer&gt; use_case별 Controller객체(route객체)를 반환해주는 composer()메서드 구현</a>
<ul>
<li class="toc-entry toc-h3"><a href="#01-oneentity의-register-usecase-composer-method부터-구현">01 OneEntity의 register Usecase composer method부터 구현</a>
<ul>
<li class="toc-entry toc-h4"><a href="#인터페이스인-routeinterface-type으로서-usecasecontroller객체를-반환해주는-use_case_composer-method-구현">인터페이스인 RouteInterface Type으로서 UseCaseController객체를 반환해주는 use_case_composer() method 구현</a></li>
<li class="toc-entry toc-h4"><a href="#생성된-usecase_controllerroute객체-반환하는-composer메서드를-init에-올리기">생성된 usecase_controller(route)객체 반환하는 composer메서드를 init에 올리기</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#4-routes-구현-전에-framework-설치후-app객체-생성">4 routes 구현 전에 Framework 설치후 app객체 생성</a>
<ul>
<li class="toc-entry toc-h3"><a href="#01-frame-workflask112부터-설치-20아직-안넘어가기">01 frame work(Flask=1.1.2)부터 설치 (2.0아직 안넘어가기)</a></li>
<li class="toc-entry toc-h3"><a href="#02-framework마다-extention으로--cors-설치">02 framework마다 extention으로 -Cors 설치</a></li>
<li class="toc-entry toc-h3"><a href="#02-mainconfigs에-apppy-생성-후-app객체-생성후-cors-ext으로-초기화">02 main&gt;configs에 app.py 생성 후 app객체 생성후 CORS ext으로 초기화</a></li>
<li class="toc-entry toc-h3"><a href="#03-app객체변수를-configs의-init에-올리기">03 app객체(변수)를 configs의 init에 올리기</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#5-routes--api_routepy에서-route등록객체-생성">5 routes &gt; api_route.py에서 route등록객체 생성</a>
<ul>
<li class="toc-entry toc-h3"><a href="#01-프레임워크flask의-route등록객체-모듈blueprint--우리의-route객체-반환메서드composer-를-import한다">01 프레임워크(flask)의 route등록객체 모듈(Blueprint) + 우리의 route객체 반환메서드(composer) 를 import한다</a>
<ul>
<li class="toc-entry toc-h4"><a href="#프레임웤의-route등록객체blueprint를-생성한다-name은-api_routes로-준다-prefix아님">프레임웤의 route등록객체(Blueprint)를 생성한다. name은 “api_routes”로 준다. (prefix아님)</a></li>
<li class="toc-entry toc-h4"><a href="#프레임웤의-dict-json-역직렬화-모듈jsonify를-import하고-예제route를-route등록객체를-통해-생성한다">프레임웤의 dict-&gt;json 역직렬화 모듈(jsonify)를 import하고 예제route를 route등록객체를 통해 생성한다</a></li>
<li class="toc-entry toc-h4"><a href="#예제-route가-작성된-route등록-객체를-init에-등록한다">예제 route가 작성된 route등록 객체를 init에 등록한다</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#02-올려놓은-route등록객체를-mainconfigsapppy에-있는-app객체에-등록한다-모든-것은-app에-등록">02 올려놓은 route등록객체를 main&gt;configs&gt;app.py에 있는 app객체에 등록한다. (모든 것은 app에 등록)</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#6-root에-runpy-정의-후-모든-것이-초기화된-app객체를-main-or-환경변수flask-run으로-실행">6 root에 run.py 정의 후 모든 것이 초기화된 app객체를 main or [환경변수+flask run]으로 실행</a>
<ul>
<li class="toc-entry toc-h3"><a href="#01-root에-runpy-생성-후-app객체-import하여-apprun">01 root에 run.py 생성 후 app객체 import하여 app.run</a></li>
<li class="toc-entry toc-h3"><a href="#02-terminal에서-runpy로-apprun시키기">02 terminal에서 run.py로 app.run시키기</a>
<ul>
<li class="toc-entry toc-h4"><a href="#flask-112-버전문제---jin">flask 1.1.2 버전문제 -&gt; jin</a></li>
<li class="toc-entry toc-h4"><a href="#flask-app객체를-srcmainconfigsapp에-있는-것을-lazy-loading한다고-뜬다">Flask app객체를 src.main.configs.app에 있는 것을 lazy loading한다고 뜬다.</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#03-환경변수에-flask_app-에-app객체-import한-python파일명을-명시하면-lazy-loading을-제거한다">03 환경변수에 FLASK_APP= 에 [app객체 import한 python파일명]을 명시하면 lazy loading을 제거한다.</a>
<ul>
<li class="toc-entry toc-h4"><a href="#python-runpy-대신-환경변수-flask_appapp객체가-import되어있는-python파일을-명시하면-main으로-인한-실행--lazyloading없이-app-discovery에-의해-빠르게-로딩된다">python run.py 대신 환경변수 FLASK_APP=[app객체가 import되어있는 python파일]을 명시하면, main으로 인한 실행 &amp;&amp; lazyloading없이 app discovery에 의해 빠르게 로딩된다.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#7-local-run-api를-postman으로-테스트">7 local run api를 POSTMAN으로 테스트</a>
<ul>
<li class="toc-entry toc-h3"><a href="#01-실행중인-url을-붙여넣고-api-uri는-srcmainroutesapi_routepy의-route등록객체를-보고-확인해서-접속한다">01 실행중인 url을 붙여넣고, api uri는 src&gt;main&gt;routes&gt;api_route.py의 route등록객체를 보고 확인해서 접속한다</a></li>
<li class="toc-entry toc-h3"><a href="#02-여기까지를-first-composer-1개--flask-setting으로-commit한다">02 여기까지를 first composer 1개 + flask setting으로 commit한다</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#참고">참고</a>
<ul>
<li class="toc-entry toc-h4"><a href="#gitignore">gitignore</a></li>
<li class="toc-entry toc-h4"><a href="#sqlalchemy패키지">sqlalchemy패키지</a></li>
<li class="toc-entry toc-h4"><a href="#github에서-br따서-작업하기">github에서 br따서 작업하기</a>
<ul>
<li class="toc-entry toc-h5"><a href="#1-1-github에서-br생성--clone">[1-1] github에서 br생성 ~ clone</a></li>
<li class="toc-entry toc-h5"><a href="#clone후-초기-작업-세팅">clone후 초기 작업 세팅</a></li>
<li class="toc-entry toc-h5"><a href="#1-2-작업끝난-br의-폴더에서-새-작업-br생성--분기게시-초기세팅-또-안해도-되는-장점">[1-2] 작업끝난 br의 폴더에서 새 작업 br생성 ~ 분기게시 (초기세팅 또 안해도 되는 장점)</a></li>
<li class="toc-entry toc-h5"><a href="#1-3--옛날에-따둔-br에서-작업시작할-땐-최신-master를-rebase후에-작업시작하기">[1-3]  옛날에 따둔 br에서 작업시작할 땐, 최신 master를 rebase후에 작업시작하기</a></li>
<li class="toc-entry toc-h5"><a href="#2-해당br-작업테스트-완료후--merge까지-정리">[2] 해당br 작업(테스트) 완료후 ~ merge까지 정리</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#vscode-설정">vscode 설정</a></li>
<li class="toc-entry toc-h4"><a href="#test정리">test정리</a></li>
<li class="toc-entry toc-h4"><a href="#status_code">status_code</a></li>
<li class="toc-entry toc-h4"><a href="#powershell-환경변수-등록확인">powershell 환경변수 등록/확인</a></li>
</ul>
</li>
</ul>
</li>
</ul><h1 id="클린-아키텍쳐-6장">
<a class="anchor" href="#%ED%81%B4%EB%A6%B0-%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-6%EC%9E%A5" aria-hidden="true"><span class="octicon octicon-link"></span></a>클린 아키텍쳐 6장</h1>

<h2 id="1-main-layer">
<a class="anchor" href="#1-main-layer" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 Main layer</h2>

<h3 id="01-src-main-폴더-및-init-생성">
<a class="anchor" href="#01-src-main-%ED%8F%B4%EB%8D%94-%EB%B0%8F-init-%EC%83%9D%EC%84%B1" aria-hidden="true"><span class="octicon octicon-link"></span></a>01 src&gt; main 폴더 및 init 생성</h3>

<h3 id="02-srcmain-composer--adapterconfigsroutesinterface-폴더-및-init생성">
<a class="anchor" href="#02-srcmain-composer--adapterconfigsroutesinterface-%ED%8F%B4%EB%8D%94-%EB%B0%8F-init%EC%83%9D%EC%84%B1" aria-hidden="true"><span class="octicon octicon-link"></span></a>02 src&gt;main&gt; composer + adapter/configs/routes/interface 폴더 및 init생성</h3>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006170716962.png" alt="image-20221006170716962"></p>

<h2 id="2-interface-controller의-interface로서-routeinterface-정의하기">
<a class="anchor" href="#2-interface-controller%EC%9D%98-interface%EB%A1%9C%EC%84%9C-routeinterface-%EC%A0%95%EC%9D%98%ED%95%98%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 interface&gt; Controller의 Interface로서 RouteInterface 정의하기</h2>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006170900078.png" alt="image-20221006170900078"></p>

<h3 id="01-maininterfaceroutepy--init-생성하고-routeinterface정의하기">
<a class="anchor" href="#01-maininterfaceroutepy--init-%EC%83%9D%EC%84%B1%ED%95%98%EA%B3%A0-routeinterface%EC%A0%95%EC%9D%98%ED%95%98%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>01 main&gt;interface&gt;route.py + init 생성하고 RouteInterface정의하기</h3>

<h4 id="route는-controller인터페이스로서-httprequest-input---httpresponse-output의-route-method로-정의한다">
<a class="anchor" href="#route%EB%8A%94-controller%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%A1%9C%EC%84%9C-httprequest-input---httpresponse-output%EC%9D%98-route-method%EB%A1%9C-%EC%A0%95%EC%9D%98%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>Route는 controller인터페이스로서, HttpRequest Input -&gt; HttpResponse Output의 route method로 정의한다.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Type</span>
<span class="kn">from</span> <span class="nn">src.presenters.helpers</span> <span class="kn">import</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">HttpResponse</span>


<span class="k">class</span> <span class="nc">RouteInterface</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="s">""" Interface to Routes """</span>

    <span class="o">@</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">route</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">http_request</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">HttpRequest</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
        <span class="s">""" Defining Route """</span>

        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"Should implement method: route"</span><span class="p">)</span>

</code></pre></div></div>

<ul>
  <li>init에 올리기</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.route</span> <span class="kn">import</span> <span class="n">RouteInterface</span>
</code></pre></div></div>

<h3 id="02-모든-controller는-routeinterface를-상속하고-controller의-메서드명-handle---route로-변경해준다">
<a class="anchor" href="#02-%EB%AA%A8%EB%93%A0-controller%EB%8A%94-routeinterface%EB%A5%BC-%EC%83%81%EC%86%8D%ED%95%98%EA%B3%A0-controller%EC%9D%98-%EB%A9%94%EC%84%9C%EB%93%9C%EB%AA%85-handle---route%EB%A1%9C-%EB%B3%80%EA%B2%BD%ED%95%B4%EC%A4%80%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>02 모든 Controller는 RouteInterface를 상속하고, controller의 메서드명 handle -&gt; route로 변경해준다.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#...
</span><span class="kn">from</span> <span class="nn">src.main.interface</span> <span class="kn">import</span> <span class="n">RouteInterface</span>
<span class="c1">#...
</span>

<span class="k">class</span> <span class="nc">FindUserController</span><span class="p">(</span><span class="n">RouteInterface</span><span class="p">):</span>
    <span class="c1">#...
</span>    <span class="k">def</span> <span class="nf">route</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">http_request</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">HttpRequest</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Type</span>
<span class="kn">from</span> <span class="nn">src.main.interface</span> <span class="kn">import</span> <span class="n">RouteInterface</span>
<span class="c1">#...
</span>
<span class="k">class</span> <span class="nc">RegisterPetController</span><span class="p">(</span><span class="n">RouteInterface</span><span class="p">):</span>
    <span class="c1">#...
</span>    <span class="k">def</span> <span class="nf">route</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">http_request</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">HttpRequest</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
</code></pre></div></div>

<h3 id="03-코드-수정후-확인은-pytest--vs-전역으로-해서-검사한다">
<a class="anchor" href="#03-%EC%BD%94%EB%93%9C-%EC%88%98%EC%A0%95%ED%9B%84-%ED%99%95%EC%9D%B8%EC%9D%80-pytest--vs-%EC%A0%84%EC%97%AD%EC%9C%BC%EB%A1%9C-%ED%95%B4%EC%84%9C-%EA%B2%80%EC%82%AC%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>03 코드 수정후 확인은 pytest -vs 전역으로 해서 검사한다</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pytest -vs
</code></pre></div></div>

<h3 id="04-commit---interface추가는-feat보다는-improve로">
<a class="anchor" href="#04-commit---interface%EC%B6%94%EA%B0%80%EB%8A%94-feat%EB%B3%B4%EB%8B%A4%EB%8A%94-improve%EB%A1%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>04 commit -&gt; interface추가는 feat:보다는 improve:로??</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git status
git add.
git commit -am "improve: Adding interfaces to controllers"
</code></pre></div></div>

<h3 id="05-생략된-controller-및-spy-추가">
<a class="anchor" href="#05-%EC%83%9D%EB%9E%B5%EB%90%9C-controller-%EB%B0%8F-spy-%EC%B6%94%EA%B0%80" aria-hidden="true"><span class="octicon octicon-link"></span></a>05 생략된 controller 및 Spy 추가</h3>

<ul>
  <li>
<a href="https://github.com/programadorLhama/Backend-Python/tree/master/src/presenters/controllers">참고 github</a>
    <ul>
      <li>register_user_controller.py 및 test</li>
      <li>find_pet_controller.py 및 test
        <ul>
          <li>src&gt;presenters&gt;controllers에 추가 및 <strong>init import</strong>
</li>
        </ul>
      </li>
      <li>find_pet_spy.py</li>
      <li>register_user_spy.py
        <ul>
          <li>src&gt;data&gt;test에 추가 및 <strong>init import</strong>
</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>전역 <code class="language-plaintext highlighter-rouge">pytest -vs</code>하면서 수정
    <ul>
      <li>원본 mock_users() -&gt; 나는 pet처럼 mock_user()로 쓰고 있다.</li>
    </ul>
  </li>
</ul>

<h2 id="3-composer-use_case별-controller객체route객체를-반환해주는-composer메서드-구현">
<a class="anchor" href="#3-composer-use_case%EB%B3%84-controller%EA%B0%9D%EC%B2%B4route%EA%B0%9D%EC%B2%B4%EB%A5%BC-%EB%B0%98%ED%99%98%ED%95%B4%EC%A3%BC%EB%8A%94-composer%EB%A9%94%EC%84%9C%EB%93%9C-%EA%B5%AC%ED%98%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>3 composer&gt; use_case별 Controller객체(route객체)를 반환해주는 composer()메서드 구현</h2>

<h3 id="01-oneentity의-register-usecase-composer-method부터-구현">
<a class="anchor" href="#01-oneentity%EC%9D%98-register-usecase-composer-method%EB%B6%80%ED%84%B0-%EA%B5%AC%ED%98%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>01 OneEntity의 register Usecase composer method부터 구현</h3>

<h4 id="인터페이스인-routeinterface-type으로서-usecasecontroller객체를-반환해주는-use_case_composer-method-구현">
<a class="anchor" href="#%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EC%9D%B8-routeinterface-type%EC%9C%BC%EB%A1%9C%EC%84%9C-usecasecontroller%EA%B0%9D%EC%B2%B4%EB%A5%BC-%EB%B0%98%ED%99%98%ED%95%B4%EC%A3%BC%EB%8A%94-use_case_composer-method-%EA%B5%AC%ED%98%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>인터페이스인 RouteInterface Type으로서 UseCaseController객체를 반환해주는 use_case_composer() method 구현</h4>

<ol>
  <li>
    <p>scr&gt;main&gt;composer &gt; <code class="language-plaintext highlighter-rouge">register_user_composite.py</code> 생성</p>
  </li>
  <li>
    <p>**controller객체 반환 Type을 위한 interface인 RouteInterface import후 <code class="language-plaintext highlighter-rouge">_composer()메서드</code> 구현 **</p>

    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">src.main.interface</span> <span class="kn">import</span> <span class="n">RouteInterface</span>
   
<span class="k">def</span> <span class="nf">register_user_composer</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RouteInterface</span><span class="p">:</span>
    <span class="s">""" Composing Register User Route
    :param - None
    :return - Object with Register User Route
    """</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>repo -&gt; usecase -&gt; controller 객체 순서대로 생성후, <strong>controller객체 == route객체 반환</strong></p>

    <ul>
      <li>usecase객체는 변수를 <strong>중간변수로서 일반명사</strong>인  <code class="language-plaintext highlighter-rouge">use_case</code>로 받자</li>
      <li>controller객체는 <strong><code class="language-plaintext highlighter-rouge">개별use_case_route</code>로 받자</strong>
</li>
    </ul>

    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">src.main.interface</span> <span class="kn">import</span> <span class="n">RouteInterface</span>
<span class="kn">from</span> <span class="nn">src.data.register_user</span> <span class="kn">import</span> <span class="n">RegisterUser</span>
<span class="kn">from</span> <span class="nn">src.infra.repo.user_repository</span> <span class="kn">import</span> <span class="n">UserRepository</span>
<span class="kn">from</span> <span class="nn">src.presenters.controllers</span> <span class="kn">import</span> <span class="n">RegisterUserController</span>
   
   
<span class="k">def</span> <span class="nf">register_user_composer</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RouteInterface</span><span class="p">:</span>
    <span class="s">""" Composing Register User Route
    :param - None
    :return - Object with Register User Route
    """</span>
   
    <span class="n">user_repository</span> <span class="o">=</span> <span class="n">UserRepository</span><span class="p">()</span>
    <span class="n">use_case</span> <span class="o">=</span> <span class="n">RegisterUser</span><span class="p">(</span><span class="n">user_repository</span><span class="p">)</span>
    <span class="n">register_user_route</span> <span class="o">=</span> <span class="n">RegisterUserController</span><span class="p">(</span><span class="n">use_case</span><span class="p">)</span>
   
    <span class="k">return</span> <span class="n">register_user_route</span>
   
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="생성된-usecase_controllerroute객체-반환하는-composer메서드를-init에-올리기">
<a class="anchor" href="#%EC%83%9D%EC%84%B1%EB%90%9C-usecase_controllerroute%EA%B0%9D%EC%B2%B4-%EB%B0%98%ED%99%98%ED%95%98%EB%8A%94-composer%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-init%EC%97%90-%EC%98%AC%EB%A6%AC%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>생성된 usecase_controller(route)객체 반환하는 composer메서드를 init에 올리기</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.register_user_composite</span> <span class="kn">import</span> <span class="n">register_user_composer</span>
</code></pre></div></div>

<h2 id="4-routes-구현-전에-framework-설치후-app객체-생성">
<a class="anchor" href="#4-routes-%EA%B5%AC%ED%98%84-%EC%A0%84%EC%97%90-framework-%EC%84%A4%EC%B9%98%ED%9B%84-app%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1" aria-hidden="true"><span class="octicon octicon-link"></span></a>4 routes 구현 전에 Framework 설치후 app객체 생성</h2>

<h3 id="01-frame-workflask112부터-설치-20아직-안넘어가기">
<a class="anchor" href="#01-frame-workflask112%EB%B6%80%ED%84%B0-%EC%84%A4%EC%B9%98-20%EC%95%84%EC%A7%81-%EC%95%88%EB%84%98%EC%96%B4%EA%B0%80%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>01 frame work(Flask=1.1.2)부터 설치 (2.0아직 안넘어가기)</h3>

<ol>
  <li>
    <p>가상환경 활성화 상태에서</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>pip3 install flask==1.1.2
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="02-framework마다-extention으로--cors-설치">
<a class="anchor" href="#02-framework%EB%A7%88%EB%8B%A4-extention%EC%9C%BC%EB%A1%9C--cors-%EC%84%A4%EC%B9%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>02 framework마다 extention으로 -Cors 설치</h3>

<ul>
  <li>
    <p>Cross Origin Resource Sharing (CORS)</p>
  </li>
  <li>
    <p>위와 같이 하면 전체 url 에 대해서 CORS 가 적용되어 <strong>다른 도메인에서 해당 url 을 호출해서 사용하는데 문제가 없습니다</strong>.</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>pip3 install Flask-Cors
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="02-mainconfigs에-apppy-생성-후-app객체-생성후-cors-ext으로-초기화">
<a class="anchor" href="#02-mainconfigs%EC%97%90-apppy-%EC%83%9D%EC%84%B1-%ED%9B%84-app%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1%ED%9B%84-cors-ext%EC%9C%BC%EB%A1%9C-%EC%B4%88%EA%B8%B0%ED%99%94" aria-hidden="true"><span class="octicon octicon-link"></span></a>02 main&gt;configs에 app.py 생성 후 app객체 생성후 CORS ext으로 초기화</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">CORS</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="03-app객체변수를-configs의-init에-올리기">
<a class="anchor" href="#03-app%EA%B0%9D%EC%B2%B4%EB%B3%80%EC%88%98%EB%A5%BC-configs%EC%9D%98-init%EC%97%90-%EC%98%AC%EB%A6%AC%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>03 app객체(변수)를 configs의 init에 올리기</h3>

<ul>
  <li>my) class, method뿐만 아니라, <code class="language-plaintext highlighter-rouge">app</code>이라는 <code class="language-plaintext highlighter-rouge">변수(객체)</code>도 import할 수 있구나</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.app</span> <span class="kn">import</span> <span class="n">app</span>
</code></pre></div></div>

<h2 id="5-routes--api_routepy에서-route등록객체-생성">
<a class="anchor" href="#5-routes--api_routepy%EC%97%90%EC%84%9C-route%EB%93%B1%EB%A1%9D%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1" aria-hidden="true"><span class="octicon octicon-link"></span></a>5 routes &gt; api_route.py에서 route등록객체 생성</h2>

<h3 id="01-프레임워크flask의-route등록객체-모듈blueprint--우리의-route객체-반환메서드composer-를-import한다">
<a class="anchor" href="#01-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%ACflask%EC%9D%98-route%EB%93%B1%EB%A1%9D%EA%B0%9D%EC%B2%B4-%EB%AA%A8%EB%93%88blueprint--%EC%9A%B0%EB%A6%AC%EC%9D%98-route%EA%B0%9D%EC%B2%B4-%EB%B0%98%ED%99%98%EB%A9%94%EC%84%9C%EB%93%9Ccomposer-%EB%A5%BC-import%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>01 프레임워크(flask)의 route등록객체 모듈(Blueprint) + 우리의 route객체 반환메서드(composer) 를 import한다</h3>

<h4 id="프레임웤의-route등록객체blueprint를-생성한다-name은-api_routes로-준다-prefix아님">
<a class="anchor" href="#%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%A4%EC%9D%98-route%EB%93%B1%EB%A1%9D%EA%B0%9D%EC%B2%B4blueprint%EB%A5%BC-%EC%83%9D%EC%84%B1%ED%95%9C%EB%8B%A4-name%EC%9D%80-api_routes%EB%A1%9C-%EC%A4%80%EB%8B%A4-prefix%EC%95%84%EB%8B%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>프레임웤의 route등록객체(Blueprint)를 생성한다. name은 “api_routes”로 준다. (prefix아님)</h4>

<ul>
  <li>fastapi는 Blueprint 대신 APIRouter를 쓴다.
    <ul>
      <li><a href="https://testdriven.io/blog/moving-from-flask-to-fastapi/">참고 사이트</a></li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span>
<span class="kn">from</span> <span class="nn">src.main.composer</span> <span class="kn">import</span> <span class="n">register_user_composer</span>

<span class="n">api_routes_bp</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s">"api_routes"</span><span class="p">,</span> <span class="n">__name__</span><span class="p">)</span>

</code></pre></div></div>

<h4 id="프레임웤의-dict-json-역직렬화-모듈jsonify를-import하고-예제route를-route등록객체를-통해-생성한다">
<a class="anchor" href="#%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%A4%EC%9D%98-dict-json-%EC%97%AD%EC%A7%81%EB%A0%AC%ED%99%94-%EB%AA%A8%EB%93%88jsonify%EB%A5%BC-import%ED%95%98%EA%B3%A0-%EC%98%88%EC%A0%9Croute%EB%A5%BC-route%EB%93%B1%EB%A1%9D%EA%B0%9D%EC%B2%B4%EB%A5%BC-%ED%86%B5%ED%95%B4-%EC%83%9D%EC%84%B1%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>프레임웤의 dict-&gt;json 역직렬화 모듈(jsonify)를 import하고 예제route를 route등록객체를 통해 생성한다</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">from</span> <span class="nn">src.main.composer</span> <span class="kn">import</span> <span class="n">register_user_composer</span>

<span class="n">api_routes_bp</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s">"api_routes"</span><span class="p">,</span> <span class="n">__name__</span><span class="p">)</span>


<span class="o">@</span><span class="n">api_routes_bp</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/api"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">"GET"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">something</span><span class="p">():</span>
    <span class="s">""" test """</span>
    
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">"Programmer"</span><span class="p">:</span> <span class="s">"Dolbum"</span><span class="p">})</span>
</code></pre></div></div>

<h4 id="예제-route가-작성된-route등록-객체를-init에-등록한다">
<a class="anchor" href="#%EC%98%88%EC%A0%9C-route%EA%B0%80-%EC%9E%91%EC%84%B1%EB%90%9C-route%EB%93%B1%EB%A1%9D-%EA%B0%9D%EC%B2%B4%EB%A5%BC-init%EC%97%90-%EB%93%B1%EB%A1%9D%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>예제 route가 작성된 route등록 객체를 init에 등록한다</h4>

<ul>
  <li>app객체, route등록객체 모두 <strong>객체(변수)단위로 init에 올린다.</strong>
</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.api_route</span> <span class="kn">import</span> <span class="n">api_routes_bp</span>
</code></pre></div></div>

<h3 id="02-올려놓은-route등록객체를-mainconfigsapppy에-있는-app객체에-등록한다-모든-것은-app에-등록">
<a class="anchor" href="#02-%EC%98%AC%EB%A0%A4%EB%86%93%EC%9D%80-route%EB%93%B1%EB%A1%9D%EA%B0%9D%EC%B2%B4%EB%A5%BC-mainconfigsapppy%EC%97%90-%EC%9E%88%EB%8A%94-app%EA%B0%9D%EC%B2%B4%EC%97%90-%EB%93%B1%EB%A1%9D%ED%95%9C%EB%8B%A4-%EB%AA%A8%EB%93%A0-%EA%B2%83%EC%9D%80-app%EC%97%90-%EB%93%B1%EB%A1%9D" aria-hidden="true"><span class="octicon octicon-link"></span></a>02 올려놓은 route등록객체를 main&gt;configs&gt;app.py에 있는 app객체에 등록한다. (모든 것은 app에 등록)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>
<span class="kn">from</span> <span class="nn">src.main.routes</span> <span class="kn">import</span> <span class="n">api_routes_bp</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">CORS</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

<span class="n">app</span><span class="p">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">api_routes_bp</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="6-root에-runpy-정의-후-모든-것이-초기화된-app객체를-main-or-환경변수flask-run으로-실행">
<a class="anchor" href="#6-root%EC%97%90-runpy-%EC%A0%95%EC%9D%98-%ED%9B%84-%EB%AA%A8%EB%93%A0-%EA%B2%83%EC%9D%B4-%EC%B4%88%EA%B8%B0%ED%99%94%EB%90%9C-app%EA%B0%9D%EC%B2%B4%EB%A5%BC-main-or-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98flask-run%EC%9C%BC%EB%A1%9C-%EC%8B%A4%ED%96%89" aria-hidden="true"><span class="octicon octicon-link"></span></a>6 root에 run.py 정의 후 모든 것이 초기화된 app객체를 main or [환경변수+flask run]으로 실행</h2>

<h3 id="01-root에-runpy-생성-후-app객체-import하여-apprun">
<a class="anchor" href="#01-root%EC%97%90-runpy-%EC%83%9D%EC%84%B1-%ED%9B%84-app%EA%B0%9D%EC%B2%B4-import%ED%95%98%EC%97%AC-apprun" aria-hidden="true"><span class="octicon octicon-link"></span></a>01 root에 run.py 생성 후 app객체 import하여 app.run</h3>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006221607127.png" alt="image-20221006221607127"></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">src.main.configs</span> <span class="kn">import</span> <span class="n">app</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">"0.0.0.0"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="02-terminal에서-runpy로-apprun시키기">
<a class="anchor" href="#02-terminal%EC%97%90%EC%84%9C-runpy%EB%A1%9C-apprun%EC%8B%9C%ED%82%A4%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>02 terminal에서 run.py로 app.run시키기</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python run.py
</code></pre></div></div>

<h4 id="flask-112-버전문제---jin">
<a class="anchor" href="#flask-112-%EB%B2%84%EC%A0%84%EB%AC%B8%EC%A0%9C---jin" aria-hidden="true"><span class="octicon octicon-link"></span></a>flask 1.1.2 버전문제 -&gt; jin</h4>

<ul>
  <li>
    <p>에러로 인해 <code class="language-plaintext highlighter-rouge">flask 업데이트</code> or <code class="language-plaintext highlighter-rouge">jinja2&lt;3.1.0 / werkzeug==2.0.3 / itsdangerous==2.0.1</code>으로 다운그레이드</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>ImportError: cannot import name 'escape' from 'jinja2'
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 install --upgrade jinja2&lt;3.1.0

pip3 install --upgrade werkzeug==2.0.3

pip3 install --upgrade itsdangerous==2.0.1
</code></pre></div></div>

<h4 id="flask-app객체를-srcmainconfigsapp에-있는-것을-lazy-loading한다고-뜬다">
<a class="anchor" href="#flask-app%EA%B0%9D%EC%B2%B4%EB%A5%BC-srcmainconfigsapp%EC%97%90-%EC%9E%88%EB%8A%94-%EA%B2%83%EC%9D%84-lazy-loading%ED%95%9C%EB%8B%A4%EA%B3%A0-%EB%9C%AC%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>Flask app객체를 src.main.configs.app에 있는 것을 lazy loading한다고 뜬다.</h4>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006222859554.png" alt="image-20221006222859554"></p>

<h3 id="03-환경변수에-flask_app-에-app객체-import한-python파일명을-명시하면-lazy-loading을-제거한다">
<a class="anchor" href="#03-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98%EC%97%90-flask_app-%EC%97%90-app%EA%B0%9D%EC%B2%B4-import%ED%95%9C-python%ED%8C%8C%EC%9D%BC%EB%AA%85%EC%9D%84-%EB%AA%85%EC%8B%9C%ED%95%98%EB%A9%B4-lazy-loading%EC%9D%84-%EC%A0%9C%EA%B1%B0%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>03 환경변수에 FLASK_APP= 에 [app객체 import한 python파일명]을 명시하면 lazy loading을 제거한다.</h3>

<h4 id="python-runpy-대신-환경변수-flask_appapp객체가-import되어있는-python파일을-명시하면-main으로-인한-실행--lazyloading없이-app-discovery에-의해-빠르게-로딩된다">
<a class="anchor" href="#python-runpy-%EB%8C%80%EC%8B%A0-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98-flask_appapp%EA%B0%9D%EC%B2%B4%EA%B0%80-import%EB%90%98%EC%96%B4%EC%9E%88%EB%8A%94-python%ED%8C%8C%EC%9D%BC%EC%9D%84-%EB%AA%85%EC%8B%9C%ED%95%98%EB%A9%B4-main%EC%9C%BC%EB%A1%9C-%EC%9D%B8%ED%95%9C-%EC%8B%A4%ED%96%89--lazyloading%EC%97%86%EC%9D%B4-app-discovery%EC%97%90-%EC%9D%98%ED%95%B4-%EB%B9%A0%EB%A5%B4%EA%B2%8C-%EB%A1%9C%EB%94%A9%EB%90%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>python run.py 대신 환경변수 FLASK_APP=[app객체가 import되어있는 python파일]을 명시하면, main으로 인한 실행 &amp;&amp; lazyloading없이 app discovery에 의해 빠르게 로딩된다.</h4>

<ul>
  <li>
<strong>venv 가상환경에 의해 환경변수가 저장</strong>된다.
    <ul>
      <li><strong>Windows Powershell, <code class="language-plaintext highlighter-rouge">venv\Scripts\activate.ps1</code>에 환경변수가 올라간다</strong></li>
    </ul>
  </li>
  <li>
<strong><code class="language-plaintext highlighter-rouge">python run.py</code>로 직접실행(lazy loading)시키려면 <code class="language-plaintext highlighter-rouge">__main__</code>이어하먄 했다</strong>
    <ul>
      <li><strong>환경변수에 의한 <code class="language-plaintext highlighter-rouge">flask run</code>실행은 app객체를 import해놓으면 알아서 탐지해서 실행된다.</strong></li>
      <li>환경변수에 의한 실행은 <code class="language-plaintext highlighter-rouge">__main__ -&gt; app.run(host=,port=)</code>가 필요없다</li>
    </ul>
  </li>
  <li><strong>venv에 환경변수 등록해놓으면 deactivate했다 들어와도 살아있다.</strong></li>
</ul>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">FLASK_APP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"run"</span><span class="w">
</span><span class="c">#export FLASK_APP=run</span><span class="w">

</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">FLASK_DEBUG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
</span><span class="c">#export FLASK_DEBUG=1</span><span class="w">

</span><span class="nf">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:</span><span class="w">
</span><span class="c">#export</span><span class="w">

</span><span class="nf">flask</span><span class="w"> </span><span class="nx">run</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006230145174.png" alt="image-20221006230145174"></p>

<h2 id="7-local-run-api를-postman으로-테스트">
<a class="anchor" href="#7-local-run-api%EB%A5%BC-postman%EC%9C%BC%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8" aria-hidden="true"><span class="octicon octicon-link"></span></a>7 local run api를 POSTMAN으로 테스트</h2>

<h3 id="01-실행중인-url을-붙여넣고-api-uri는-srcmainroutesapi_routepy의-route등록객체를-보고-확인해서-접속한다">
<a class="anchor" href="#01-%EC%8B%A4%ED%96%89%EC%A4%91%EC%9D%B8-url%EC%9D%84-%EB%B6%99%EC%97%AC%EB%84%A3%EA%B3%A0-api-uri%EB%8A%94-srcmainroutesapi_routepy%EC%9D%98-route%EB%93%B1%EB%A1%9D%EA%B0%9D%EC%B2%B4%EB%A5%BC-%EB%B3%B4%EA%B3%A0-%ED%99%95%EC%9D%B8%ED%95%B4%EC%84%9C-%EC%A0%91%EC%86%8D%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>01 실행중인 url을 붙여넣고, api uri는 src&gt;main&gt;routes&gt;api_route.py의 route등록객체를 보고 확인해서 접속한다</h3>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006230833856.png" alt="image-20221006230833856"></p>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006230842123.png" alt="image-20221006230842123"></p>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006230852374.png" alt="image-20221006230852374"></p>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221006230929493.png" alt="image-20221006230929493"></p>

<h3 id="02-여기까지를-first-composer-1개--flask-setting으로-commit한다">
<a class="anchor" href="#02-%EC%97%AC%EA%B8%B0%EA%B9%8C%EC%A7%80%EB%A5%BC-first-composer-1%EA%B0%9C--flask-setting%EC%9C%BC%EB%A1%9C-commit%ED%95%9C%EB%8B%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>02 여기까지를 first composer 1개 + flask setting으로 commit한다</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit -am "feat: Implementing first composer and setting Flask"
</code></pre></div></div>

<h2 id="참고">
<a class="anchor" href="#%EC%B0%B8%EA%B3%A0" aria-hidden="true"><span class="octicon octicon-link"></span></a>참고</h2>

<ul>
  <li><a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html">Robert C. Martin (Uncle Bob)의 Clean Code Blog</a></li>
  <li><a href="https://velog.io/@jahoy/Python%EC%9C%BC%EB%A1%9C-Clean-Architecture-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0">용어 참고 블로그 1편</a></li>
  <li><a href="https://velog.io/@jahoy/Python%EC%9C%BC%EB%A1%9C-%ED%81%B4%EB%A6%B0-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B02">용어 참고 블로그 2편</a></li>
</ul>

<h4 id="gitignore">
<a class="anchor" href="#gitignore" aria-hidden="true"><span class="octicon octicon-link"></span></a>gitignore</h4>

<ul>
  <li>
    <p>git에 commit되었던 것을 ignore하고 싶을 때</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git rm [파일명] --cached
</code></pre></div>    </div>
  </li>
  <li>
    <p>git amend</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git commit --amend --no-edit
</code></pre></div>    </div>
  </li>
</ul>

<ol>
  <li>console 등에서 init import부터 생기는 pycache폴더</li>
  <li>venv</li>
  <li>연습용 sqlite .db파일</li>
  <li>pytest시 생기는 .pytest_cache 폴더</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>**/__pycache__
venv
storage.db
.pytest_cache
</code></pre></div></div>

<h4 id="sqlalchemy패키지">
<a class="anchor" href="#sqlalchemy%ED%8C%A8%ED%82%A4%EC%A7%80" aria-hidden="true"><span class="octicon octicon-link"></span></a>sqlalchemy패키지</h4>

<ul>
  <li>일반 패키지: create_engine / 칼럼재료들</li>
  <li>.orm 패키지:
    <ul>
      <li>relatioship: 1:M에서 1에 해당하는 table이 들고 있는 가짜칼럼</li>
      <li>sessionmaker: handler class 속 enter에서 engine을 묶어서 session을 반환해주는 놈</li>
    </ul>
  </li>
  <li>계층별 변수정리
    <ul>
      <li>id : sqlalchemy -&gt; <strong>repo부터는</strong> fk_id도 있으니 <code class="language-plaintext highlighter-rouge">pk_id</code>
</li>
      <li>name: sqlalchemy-&gt;repo-&gt;usecase까지는 그냥 name (선택인자 개별메서드에by_name)-&gt; <strong>controller부터는 외부에선 다른(pet)_name도 있으니 <code class="language-plaintext highlighter-rouge">pk_name</code></strong>
</li>
    </ul>
  </li>
</ul>

<h4 id="github에서-br따서-작업하기">
<a class="anchor" href="#github%EC%97%90%EC%84%9C-br%EB%94%B0%EC%84%9C-%EC%9E%91%EC%97%85%ED%95%98%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>github에서 br따서 작업하기</h4>

<h5 id="1-1-github에서-br생성--clone">
<a class="anchor" href="#1-1-github%EC%97%90%EC%84%9C-br%EC%83%9D%EC%84%B1--clone" aria-hidden="true"><span class="octicon octicon-link"></span></a>[1-1] github에서 br생성 ~ clone</h5>

<ol>
  <li>
    <p>github에 들어가서 <code class="language-plaintext highlighter-rouge">feat/~</code>로 브랜치 생성</p>
  </li>
  <li>
    <p>해당 br만 clone</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git clone -b [branch] [git주소]
</code></pre></div>    </div>
  </li>
</ol>

<h5 id="clone후-초기-작업-세팅">
<a class="anchor" href="#clone%ED%9B%84-%EC%B4%88%EA%B8%B0-%EC%9E%91%EC%97%85-%EC%84%B8%ED%8C%85" aria-hidden="true"><span class="octicon octicon-link"></span></a>clone후 초기 작업 세팅</h5>

<ol>
  <li>gitignore중에 db파일 있으면 옮겨주기
    <ul>
      <li>없으면 config import해서 Base + handler -&gt; get_enigne -&gt; bind한 다음, create_all()해줘야할듯??</li>
    </ul>
  </li>
</ol>

<p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20220929154256052.png" alt="image-20220929154256052"></p>

<ol>
  <li>github에서 따온 빈 새br에 대해, venv를 만들고 활성화하고  vscode를 연다</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python -m virtualenv -p python310 venv

.\venv\Scripts\activate
</code></pre></div></div>

<ol>
  <li>최초 requirements.txt 직접 설치</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 install -r requirements.txt
</code></pre></div></div>

<ol>
  <li>최초 pre-commit install 직접 세팅</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pre-commit install
</code></pre></div></div>

<ol>
  <li>vscode 열고 interpreter venv로 지정</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>code .
</code></pre></div></div>

<h5 id="1-2-작업끝난-br의-폴더에서-새-작업-br생성--분기게시-초기세팅-또-안해도-되는-장점">
<a class="anchor" href="#1-2-%EC%9E%91%EC%97%85%EB%81%9D%EB%82%9C-br%EC%9D%98-%ED%8F%B4%EB%8D%94%EC%97%90%EC%84%9C-%EC%83%88-%EC%9E%91%EC%97%85-br%EC%83%9D%EC%84%B1--%EB%B6%84%EA%B8%B0%EA%B2%8C%EC%8B%9C-%EC%B4%88%EA%B8%B0%EC%84%B8%ED%8C%85-%EB%98%90-%EC%95%88%ED%95%B4%EB%8F%84-%EB%90%98%EB%8A%94-%EC%9E%A5%EC%A0%90" aria-hidden="true"><span class="octicon octicon-link"></span></a>[1-2] 작업끝난 br의 폴더에서 새 작업 br생성 ~ 분기게시 (초기세팅 또 안해도 되는 장점)</h5>

<ol>
  <li>
    <p>현재 br를 확인한다.</p>

    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">git</span> <span class="n">branch</span>
<span class="o">*</span> <span class="n">feat</span><span class="o">/</span><span class="n">register_user_use_case</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>checkout -b</strong>로 새 br 생성하여 진입하기</p>

    <ul>
      <li>원래는 github에서 create branch했었음.</li>
    </ul>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git checkout -b feat/generic_use_cases
   
git branch
   
* feat/generic_use_cases
  feat/register_user_use_case
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>git push -u origin [branch명]으로 <code class="language-plaintext highlighter-rouge">새로생성한 br를 push해서 github에 생성하기</code></strong></p>

    <ul>
      <li>vscode에서는 push -u origin [branch] 대신  <strong><code class="language-plaintext highlighter-rouge">분기게시</code>가 뜬다.</strong>
</li>
    </ul>
  </li>
  <li>
    <p>github에서 <strong>빈 분기가 생성되었는지 확인하기</strong></p>

    <ul>
      <li>github에 merge되기 위해서는 <strong>직전 작업이후 <code class="language-plaintext highlighter-rouge">github에 새 작업 br를 먼저 생성해놓고 작업</code>에 들어가야한다</strong>
</li>
    </ul>
  </li>
</ol>

<h5 id="1-3--옛날에-따둔-br에서-작업시작할-땐-최신-master를-rebase후에-작업시작하기">
<a class="anchor" href="#1-3--%EC%98%9B%EB%82%A0%EC%97%90-%EB%94%B0%EB%91%94-br%EC%97%90%EC%84%9C-%EC%9E%91%EC%97%85%EC%8B%9C%EC%9E%91%ED%95%A0-%EB%95%90-%EC%B5%9C%EC%8B%A0-master%EB%A5%BC-rebase%ED%9B%84%EC%97%90-%EC%9E%91%EC%97%85%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>[1-3]  옛날에 따둔 br에서 작업시작할 땐, 최신 master를 rebase후에 작업시작하기</h5>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">git checkout master</code>를 통해 <strong>안가져와서 안보이던 master</strong>를 만든다</p>

    <ul>
      <li>
<strong>-b의 새로만든 것이 아니므로</strong> remote와 연결된 master가 된다.</li>
      <li>
<code class="language-plaintext highlighter-rouge">git branch</code>로 확인</li>
    </ul>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git checkout master
   
git branch
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">git pull</code>로 master에 최신 코드를 가져온다</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git pull
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>rebase받을 업뎃안된 작업br로 넘어간 뒤, <code class="language-plaintext highlighter-rouge">matser의 내용을 rebase로 받아온다</code></strong></p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git checkout [작업br]
   
git rebase master
   
git log --oneline
</code></pre></div>    </div>
  </li>
</ol>

<h5 id="2-해당br-작업테스트-완료후--merge까지-정리">
<a class="anchor" href="#2-%ED%95%B4%EB%8B%B9br-%EC%9E%91%EC%97%85%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%99%84%EB%A3%8C%ED%9B%84--merge%EA%B9%8C%EC%A7%80-%EC%A0%95%EB%A6%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>[2] 해당br 작업(테스트) 완료후 ~ merge까지 정리</h5>

<ol>
  <li>
    <p>status 확인후 add . 후  -am으로 커밋-&gt;실패-&gt;-am커밋</p>

    <ul>
      <li><strong>add를 먼저 날려야 add된상태로 pytest하는 것 같다?!</strong></li>
    </ul>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git status
   
git add .
   
git commit -am "feat: implementing data interfaces"
   
git commit -am "feat: implementing data interfaces"
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>git push는 현재 로그인된 vscode에서 하고 있음.</strong></p>
  </li>
  <li>
    <p><strong>github에 들어가보면, <code class="language-plaintext highlighter-rouge">Compare &amp; pull request</code>가 떠있더라도 <code class="language-plaintext highlighter-rouge">PR탭 &gt; new PR</code>로 들어가는 버릇을 들여보자.</strong></p>
  </li>
</ol>

<ul>
  <li>Comparing change까지 들어가서 코드를 확인하고 <code class="language-plaintext highlighter-rouge">Able to merge</code> 및 <code class="language-plaintext highlighter-rouge">세부코드</code>를 확인하고 <strong>직접 Create PR까지 가자</strong>
</li>
</ul>

<ol>
  <li><strong>merge후 master에 반영되었는지까지 확인하자</strong></li>
</ol>

<h4 id="vscode-설정">
<a class="anchor" href="#vscode-%EC%84%A4%EC%A0%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>vscode 설정</h4>

<ul>
  <li>캐쉬파일 안보이기</li>
</ul>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"files.exclude"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"**/__pycache__"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"**/.pytest_cache"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<ul>
  <li>
    <p>tab시 space로 입력되기</p>

    <p><img src="https://raw.githubusercontent.com/is3js/screenshots/main/image-20221001015405760.png" alt="image-20221001015405760"></p>
  </li>
  <li>
    <p>탐색기 열기 단축키 : <code class="language-plaintext highlighter-rouge">shift + alt + R</code></p>

    <ul>
      <li>파일: 파일 탐색기에 표시</li>
    </ul>
  </li>
</ul>

<h4 id="test정리">
<a class="anchor" href="#test%EC%A0%95%EB%A6%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>test정리</h4>

<ol>
  <li>
    <p>repo_insert_X</p>

    <ol>
      <li>id제외 faker + insert메서드 -&gt; new_dto</li>
      <li>new_dto속 배정id + engine db select -&gt; query_data -&gt; engine db delete</li>
      <li>assert new_dto.필드 == query_data필드 비교</li>
    </ol>
  </li>
  <li>
    <p>repo_select_X</p>
    <ol>
      <li>id포함 faker -&gt; entity모델 객체</li>
      <li>id포함 재료들 + engine db insert -&gt; db데이터만들어놓기</li>
      <li>id, fk재료들 + select메서드 -&gt; List[entity모델객체들]</li>
      <li>engine db delete</li>
    </ol>
  </li>
</ol>

<h4 id="status_code">
<a class="anchor" href="#status_code" aria-hidden="true"><span class="octicon octicon-link"></span></a>status_code</h4>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">422</code>: validate_entry실패하는 query 속 param들 -&gt; usecase메서드의 결과물 response의 [“Success”]가 False</p>

    <ul>
      <li><strong>필수param(dict속 필드)이 빠졌을 경우(존재검증) or 필수param이 validate_entry실패할 경우</strong></li>
    </ul>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>if reponse["Success"] is False:
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">400</code>: query속 param들이 필요한 controller인데 http_request안에 아예 존재도 안했다면, 400 Bad Request에러</p>

    <ul>
      <li><strong>http_request에 필수param을 포함한 .query or .body가 아예 날라오지도 않았을 경우</strong></li>
    </ul>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>if http_request.query:
	# if query
# if not query
else:
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>if http_request.body:
	# if body
# if not body
else:
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="powershell-환경변수-등록확인">
<a class="anchor" href="#powershell-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98-%EB%93%B1%EB%A1%9D%ED%99%95%EC%9D%B8" aria-hidden="true"><span class="octicon octicon-link"></span></a>powershell 환경변수 등록/확인</h4>

<ul>
  <li>python가상환경 venv에서 activated한 상태로 적용
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">venv\Scripts\activate.ps1</code>에 저장된다.</li>
    </ul>
  </li>
</ul>

<ol>
  <li>
    <p>등록:</p>

    <div class="language-powershell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">FLASK_APP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"hello"</span><span class="w">
   
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">FLASK_DEBUG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
</span></code></pre></div>    </div>

    <ul>
      <li>파일명은 “ “ 확장자를 뺀 쌍따옴표로</li>
    </ul>

    <div class="language-powershell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">FLASK_RUN_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8000</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>확인</p>

    <div class="language-powershell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nf">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-powershell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nf">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Format-Table</span><span class="w"> </span><span class="nt">-Wrap</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-powershell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c">## 'LOGONSERVER' 환경변수를 찾고 싶다면,</span><span class="w">
</span><span class="nf">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:LOGONSERVER</span><span class="w">
   
</span><span class="c">## 'on'이 포함된 단어, ex) logONserver, ONedrive...</span><span class="w">
</span><span class="nf">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:</span><span class="o">*</span><span class="nx">on</span><span class="o">*</span><span class="w">
   
</span><span class="c">## 'on'으로 시작하는 단어, ONedrive ...</span><span class="w">
</span><span class="nf">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:on</span><span class="o">*</span><span class="w">
   
</span><span class="c">## 'on'으로 끝나는 단어, ex) processor_revisiON ...</span><span class="w">
</span><span class="nf">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:</span><span class="o">*</span><span class="nx">on</span><span class="w">
</span></code></pre></div>    </div>
  </li>
</ol>


  </div><a class="u-url" href="/python/flask/cleanarchitecture/2022/09/06/%ED%81%B4%EB%A6%B0%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90_06_main_layer_OneEntity_composer_and_setting_flask.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>평범한 한의사 돌범의 엔지니어 도전기</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/is2js" target="_blank" title="is2js"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/is2js" target="_blank" title="is2js"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
